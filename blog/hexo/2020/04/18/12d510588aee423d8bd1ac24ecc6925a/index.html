<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>使用 Java8 新的时间 API | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="简介Java8 面世以来已经 6 年了，许多人也开始使用起了 lambda,Stream&lt;T&gt;,Optional&lt;T&gt; 之类的新的语言特性，然而对于 Java8 提供的新的时间 API 虽然据说比旧版本的 Date 好很多，但并没有得到完全的使用。一方面是为了兼容旧的系统，另一方面 Java8 的时间 API 似乎太过于强大了，让人有些不知所措，不知道应该从何下手。再加上因">
<meta property="og:type" content="article">
<meta property="og:title" content="使用 Java8 新的时间 API">
<meta property="og:url" content="http://example.com/2020/04/18/12d510588aee423d8bd1ac24ecc6925a/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="简介Java8 面世以来已经 6 年了，许多人也开始使用起了 lambda,Stream&lt;T&gt;,Optional&lt;T&gt; 之类的新的语言特性，然而对于 Java8 提供的新的时间 API 虽然据说比旧版本的 Date 好很多，但并没有得到完全的使用。一方面是为了兼容旧的系统，另一方面 Java8 的时间 API 似乎太过于强大了，让人有些不知所措，不知道应该从何下手。再加上因">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-04-18T02:14:09.000Z">
<meta property="article:modified_time" content="2020-12-29T17:08:53.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-12d510588aee423d8bd1ac24ecc6925a" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/04/18/12d510588aee423d8bd1ac24ecc6925a/" class="article-date">
  <time class="dt-published" datetime="2020-04-18T02:14:09.000Z" itemprop="datePublished">2020-04-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      使用 Java8 新的时间 API
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Java8 面世以来已经 6 年了，许多人也开始使用起了 <code>lambda</code>,<code>Stream&lt;T&gt;</code>,<code>Optional&lt;T&gt;</code> 之类的新的语言特性，然而对于 Java8 提供的新的时间 <code>API</code> 虽然据说比旧版本的 <code>Date</code> 好很多，但并没有得到完全的使用。一方面是为了兼容旧的系统，另一方面 Java8 的时间 API 似乎太过于强大了，让人有些不知所措，不知道应该从何下手。再加上因为对 <code>Date</code>,<code>Calendar</code> 的熟悉，此消彼长之下自然是懒得去修改了。</p>
<p>其实对于时间 API，大致的需求是一样的</p>
<ul>
<li>创建/修改/比较/转换简单</li>
<li>对遗留系统的时间可以集成/转换</li>
<li>主流框架对其要有支持</li>
</ul>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><h3 id="常用的类"><a href="#常用的类" class="headerlink" title="常用的类"></a>常用的类</h3><ul>
<li><a href="#LocalDate">LocalDate</a>: 日期的不可变类</li>
<li><a href="#LocalTime">LocalTime</a>: 时间的不可变类</li>
<li><a href="#LocalDateTime">LocalDateTime</a>: 日期时间的不可变类</li>
<li><a href="#OffsetDateTime">OffsetDateTime</a>: 偏移标准 UTC 时间的日期时间不可变类</li>
<li><a href="#Temporal/TemporalAccessor">Temporal/TemporalAccessor</a>: 上面几个时间类的基类</li>
<li><a href="#Period">Period</a>: 计算日期差值</li>
<li><a href="#Duration">Duration</a>: 计算日期时间差值</li>
<li><a href="#TemporalField/ChronoField">ChronoField/TemporalField</a>: 时间的单位</li>
<li><a href="#TemporalUnit/ChronoUnit">ChronoUnit/TemporalUnit</a>: 根据指定的单位计算时间</li>
<li><a href="#DateTimeFormatter">DateTimeFormatter</a>: 时间格式化</li>
<li><a href="#%E5%85%BC%E5%AE%B9-Date">兼容 Date</a>: 兼容旧的 Date 类</li>
</ul>
<h3 id="LocalDate"><a href="#LocalDate" class="headerlink" title="LocalDate"></a>LocalDate</h3><p>一个不可变（线程安全）的日期对象，用且表示 <em>年-月-日</em> 的时间，默认 <code>toString()</code> 格式是 <code>yyyy-MM-dd</code>。</p>
<p>基本操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取当前的日期</span></span><br><span class="line"><span class="keyword">final</span> LocalDate now = LocalDate.now();</span><br><span class="line"><span class="comment">//toString 一下日期</span></span><br><span class="line"><span class="comment">//会得到 yyyy-MM-dd 格式</span></span><br><span class="line">System.out.println(<span class="string">&quot;现在：&quot;</span> + now);</span><br><span class="line"><span class="comment">//1 天后的日期</span></span><br><span class="line"><span class="keyword">final</span> LocalDate localDatePlusDayOne = now.plusDays(<span class="number">1</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;一天后：&quot;</span> + localDatePlusDayOne);</span><br><span class="line"><span class="comment">//一天前的日期</span></span><br><span class="line"><span class="keyword">final</span> LocalDate localDateMinusDayOne = now.minusDays(<span class="number">1</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;一天前：&quot;</span> + localDateMinusDayOne);</span><br><span class="line"><span class="comment">//比较两个日期/时间的大小</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> nowEvenBigger = now.compareTo(localDatePlusDayOne);</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间更大么？&quot;</span> + nowEvenBigger);</span><br><span class="line"><span class="comment">//获取指定单位的日期（年/月/日/星期）</span></span><br><span class="line"><span class="comment">//获取当前月的时间</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> dayOfMonth = now.getDayOfMonth();</span><br><span class="line">System.out.println(<span class="string">&quot;当前月的天数：&quot;</span> + dayOfMonth);</span><br><span class="line"><span class="comment">//更加通用获取方式</span></span><br><span class="line"><span class="comment">//使用枚举类 ChronoField</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> dayOfMonthForChronoField = now.get(ChronoField.DAY_OF_MONTH);</span><br><span class="line">System.out.println(<span class="string">&quot;当前月的天数（通过 get() 获取）：&quot;</span> + dayOfMonthForChronoField);</span><br><span class="line"><span class="comment">//比较两个日期的差值</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">long</span> between = ChronoUnit.DAYS.between(now, localDatePlusDayOne);</span><br><span class="line">System.out.println(between);</span><br></pre></td></tr></table></figure>
<p>上面有些地方看不太懂不碍事，先过一遍，下面对其中的部分代码会有解释</p>
<h3 id="LocalTime"><a href="#LocalTime" class="headerlink" title="LocalTime"></a>LocalTime</h3><p>一个不可变的（线程安全）的时间对象，用于表示 <em>时：分：秒：毫秒</em> 的时间，默认 <code>toString()</code> 格式是 <code>hh:mm:ss.SSS</code>。</p>
<p>基本操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获得当前时间</span></span><br><span class="line"><span class="keyword">final</span> LocalTime now = LocalTime.now();</span><br><span class="line"><span class="comment">//默认格式 hh:mm:ss.SSS</span></span><br><span class="line">System.out.println(<span class="string">&quot;现在：&quot;</span> + now);</span><br><span class="line"><span class="comment">//一个小时后的时间</span></span><br><span class="line"><span class="keyword">final</span> LocalTime localTimePlusHourOne = now.plusHours(<span class="number">1</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;一小时后：&quot;</span> + localTimePlusHourOne);</span><br><span class="line"><span class="comment">//一分钟前的时间</span></span><br><span class="line"><span class="keyword">final</span> LocalTime localTimeMinusMinuteOne = now.minusMinutes(<span class="number">1</span>);</span><br><span class="line">System.out.println(localTimeMinusMinuteOne);</span><br><span class="line"><span class="comment">//比较时间大小（实现了 Comparable 接口）</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> nowEvenBigger = now.compareTo(localTimeMinusMinuteOne);</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间更大么？&quot;</span> + nowEvenBigger);</span><br><span class="line"><span class="comment">//获取指定单位的时间</span></span><br><span class="line"><span class="comment">//当前小时数</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> hour = now.getHour();</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间的小时数：&quot;</span> + hour);</span><br><span class="line"><span class="comment">//使用枚举类 ChronoField 获取</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> hourOfDay = now.get(ChronoField.HOUR_OF_DAY);</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间的小时数（通过 get() 获取）：&quot;</span> + hourOfDay);</span><br><span class="line"><span class="comment">//比较两个日期的差值</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">long</span> between = ChronoUnit.HOURS.between(now, localTimePlusHourOne);</span><br><span class="line">System.out.println(between);</span><br></pre></td></tr></table></figure>
<h3 id="LocalDateTime"><a href="#LocalDateTime" class="headerlink" title="LocalDateTime"></a>LocalDateTime</h3><p>不可变的日期时间对象，用于表示 <em>日-月-年 时：分：秒：毫秒</em> 的日期时间，默认格式化格式是 <code>yyyy-MM-ddThh:mm:ss.SSS</code>。</p>
<p>基本操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当前日期时间</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime now = LocalDateTime.now();</span><br><span class="line"><span class="comment">//默认格式 yyyy-MM-ddThh:mm:ss.SSS</span></span><br><span class="line">System.out.println(<span class="string">&quot;现在：&quot;</span> + now);</span><br><span class="line"><span class="comment">//一个小时后的时间</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime localTimePlusHourOne = now.plusHours(<span class="number">1</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;一小时后：&quot;</span> + localTimePlusHourOne);</span><br><span class="line"><span class="comment">//一分钟前的时间</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime localTimeMinusMinuteOne = now.minusMinutes(<span class="number">1</span>);</span><br><span class="line">System.out.println(localTimeMinusMinuteOne);</span><br><span class="line"><span class="comment">//比较时间大小（实现了 Comparable 接口）</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> nowEvenBigger = now.compareTo(localTimeMinusMinuteOne);</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间更大么？&quot;</span> + nowEvenBigger);</span><br><span class="line"><span class="comment">//获取指定单位的时间</span></span><br><span class="line"><span class="comment">//当前小时数</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> hour = now.getHour();</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间的小时数：&quot;</span> + hour);</span><br><span class="line"><span class="comment">//使用枚举类 ChronoField 获取</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> hourOfDay = now.get(ChronoField.HOUR_OF_DAY);</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间的小时数（通过 get() 获取）：&quot;</span> + hourOfDay);</span><br><span class="line"><span class="comment">//比较两个日期的差值</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">long</span> between = ChronoUnit.HOURS.between(now, localTimePlusHourOne);</span><br><span class="line">System.out.println(between);</span><br><span class="line"><span class="comment">//获取一天的开始和结束</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime start = LocalDateTime.of(yesterday, LocalTime.MIN);</span><br><span class="line"><span class="keyword">final</span> LocalDateTime end = LocalDateTime.of(yesterday, LocalTime.MAX);</span><br><span class="line">System.out.println(start);</span><br><span class="line">System.out.println(end);</span><br></pre></td></tr></table></figure>
<p>可以看到，和上面的 <a href="#LocalTime">LocalTime</a> 除了类型不同外，代码是完全相同的，因为 <a href="#LocalDateTime">LocalDateTime</a> 是包含 <a href="#LocalDate">LocalDate</a> 与 <a href="#LocalTime">LocalTime</a> 的。在源码中也可以看到其包含了两个属性。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取日期/时间对象</span></span><br><span class="line"><span class="keyword">final</span> LocalDate localDate = now.toLocalDate();</span><br><span class="line"><span class="keyword">final</span> LocalTime localTime = now.toLocalTime();</span><br><span class="line">System.out.println(<span class="string">&quot;当前日期：&quot;</span> + localDate);</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间：&quot;</span> + localTime);</span><br></pre></td></tr></table></figure>
<h3 id="OffsetDateTime"><a href="#OffsetDateTime" class="headerlink" title="OffsetDateTime"></a>OffsetDateTime</h3><p>代表偏移标准 UTC 时间的日期时间不可变对象，用于表示 _日-月-年 时：分：秒：毫秒时区_，默认格式是 <code>yyyy-MM-ddThh:mm:ss.SSSZoneId</code></p>
<p>基本操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当前偏移的日期时间</span></span><br><span class="line"><span class="keyword">final</span> OffsetDateTime now = OffsetDateTime.now();</span><br><span class="line">System.out.println(now);</span><br><span class="line"><span class="comment">//其实个人感觉就是多了一个时区</span></span><br><span class="line"><span class="comment">//获取到时区</span></span><br><span class="line">ZoneId zone = now.toZonedDateTime().getZone();</span><br><span class="line">System.out.println(zone);</span><br><span class="line"><span class="comment">//转换时区</span></span><br><span class="line">ZonedDateTime zonedDateTime = now.atZoneSameInstant(ZoneId.of(<span class="string">&quot;+00:00&quot;</span>));</span><br><span class="line">System.out.println(zonedDateTime);</span><br><span class="line"><span class="comment">//其他基本操作和上面的差不多，就不啰嗦啦</span></span><br></pre></td></tr></table></figure>
<h3 id="Temporal-TemporalAccessor"><a href="#Temporal-TemporalAccessor" class="headerlink" title="Temporal/TemporalAccessor"></a>Temporal/TemporalAccessor</h3><p>上面的 <a href="#LocalDate">LocalDate</a>, <a href="#LocalTime">LocalTime</a>, <a href="#LocalDateTime">LocalDateTime</a>, <a href="#OffsetDateTime">OffsetDateTime</a> 的基类，并定义了一系列非常通用的方法</p>
<ul>
<li>minus: 减少时间</li>
<li>plus: 增加时间</li>
<li>with: 获取时间指定单位的值</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> LocalDateTime now = LocalDateTime.now();</span><br><span class="line"><span class="comment">//获取上个星期</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime lastWeek = now.minus(<span class="number">1</span>, ChronoUnit.WEEKS);</span><br><span class="line"><span class="comment">//获取下个月</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime nextMonth = now.plus(<span class="number">1</span>, ChronoUnit.MONTHS);</span><br><span class="line"><span class="comment">//获取当前是今年的第几个星期</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> weekValue = now.get(ChronoField.ALIGNED_WEEK_OF_YEAR);</span><br><span class="line"><span class="comment">//获取这周星期一的时间</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime nowOfMonday = now.with(DayOfWeek.MONDAY);</span><br><span class="line"><span class="keyword">final</span> LocalDateTime nowOfMonday2 = now.with(ChronoField.DAY_OF_WEEK, <span class="number">1</span>);</span><br><span class="line">System.out.println(</span><br><span class="line">    <span class="string">&quot;lastWeek: &quot;</span> + lastWeek</span><br><span class="line">        + <span class="string">&quot;\nnextMonth: &quot;</span> + nextMonth</span><br><span class="line">        + <span class="string">&quot;\nweekValue: &quot;</span> + weekValue</span><br><span class="line">        + <span class="string">&quot;\nnowOfMonday: &quot;</span> + nowOfMonday</span><br><span class="line">        + <span class="string">&quot;\nnowOfMonday2: &quot;</span> + nowOfMonday2</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="Period"><a href="#Period" class="headerlink" title="Period"></a>Period</h3><p>代表两个日期的差值，默认 <code>toString()</code> 格式是 <code>P([时间][单位])*</code></p>
<p>基本操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> LocalDate now = LocalDate.now();</span><br><span class="line"><span class="keyword">final</span> LocalDate localTimePlusMonthOne = now.plusDays(<span class="number">1</span>);</span><br><span class="line"><span class="comment">//计算相差的时间</span></span><br><span class="line"><span class="keyword">final</span> Period betweenForDay = Period.between(now, localTimePlusMonthOne);</span><br><span class="line"><span class="comment">//获取相差的天数</span></span><br><span class="line">System.out.println(<span class="string">&quot;相差的天数：&quot;</span> + betweenForDay.getDays());</span><br><span class="line"><span class="comment">//使用 get() 方法获取通用的相差的天数</span></span><br><span class="line">System.out.println(<span class="string">&quot;相差的天数(使用 get() 获取)：&quot;</span> + betweenForDay.get(ChronoUnit.DAYS));</span><br><span class="line"><span class="comment">//对相差的日期减去一天并判断是否为 0</span></span><br><span class="line">System.out.println(<span class="string">&quot;相差的日期减去 1 天是不是就相同了呢？&quot;</span> + betweenForDay.minusDays(<span class="number">1</span>).isZero());</span><br></pre></td></tr></table></figure>
<h3 id="Duration"><a href="#Duration" class="headerlink" title="Duration"></a>Duration</h3><p>代表两个日期时间的差值，默认 <code>toString()</code> 格式是 <code>PT([时间][单位])*</code></p>
<p>基本操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> LocalDateTime now = LocalDateTime.now();</span><br><span class="line"><span class="keyword">final</span> LocalDateTime localDateTimeForPlusHourOne = now.plusHours(<span class="number">1</span>);</span><br><span class="line"><span class="comment">//计算两个时间的差值</span></span><br><span class="line"><span class="keyword">final</span> Duration between = Duration.between(now, localDateTimeForPlusHourOne);</span><br><span class="line"><span class="comment">//默认格式是 PT 时间 单位</span></span><br><span class="line">System.out.println(<span class="string">&quot;相差的时间：&quot;</span> + between);</span><br><span class="line"><span class="comment">//获取日期</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">long</span> betweenSeconds = between.getSeconds();</span><br><span class="line">System.out.println(<span class="string">&quot;相差的时间（/秒）：&quot;</span> + betweenSeconds);</span><br><span class="line"><span class="comment">//根据指定单位获取相差时间的大小</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">long</span> betweenSecondsForGet = between.get(ChronoUnit.SECONDS);</span><br><span class="line">System.out.println(<span class="string">&quot;相差的时间（/秒）：&quot;</span> + betweenSecondsForGet);</span><br><span class="line"><span class="comment">//转换成毫秒</span></span><br><span class="line">System.out.println(<span class="string">&quot;相差的时间（/毫秒）：&quot;</span> + between.toMillis());</span><br><span class="line"><span class="comment">//获取相差时间支持的单位列表（其实感觉上没太大意义）</span></span><br><span class="line"><span class="keyword">final</span> List&lt;TemporalUnit&gt; temporalUnitList = between.getUnits();</span><br><span class="line">System.out.println(<span class="string">&quot;相差的时间列表：&quot;</span> + temporalUnitList);</span><br><span class="line"><span class="comment">//在创建一个时间差</span></span><br><span class="line"><span class="keyword">final</span> Duration betweenForMinutes = Duration.between(now, now.minusMinutes(<span class="number">100</span>));</span><br><span class="line"><span class="comment">//判断两个时间差哪个更大</span></span><br><span class="line">System.out.println(<span class="string">&quot;between 的时间差更大么？&quot;</span> + between.compareTo(betweenForMinutes));</span><br><span class="line"><span class="comment">//获取绝对值</span></span><br><span class="line">System.out.println(<span class="string">&quot;相差的绝对时间：&quot;</span> + betweenForMinutes.abs());</span><br></pre></td></tr></table></figure>
<h3 id="TemporalField-ChronoField"><a href="#TemporalField-ChronoField" class="headerlink" title="TemporalField/ChronoField"></a>TemporalField/ChronoField</h3><p>日期/时间单位字段，TemporalField 是接口，ChronoField 则是实现类。</p>
<p>基本操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> LocalDateTime now = LocalDateTime.now();</span><br><span class="line"><span class="keyword">final</span> ChronoField hourOfDay = ChronoField.HOUR_OF_DAY;</span><br><span class="line">System.out.println(hourOfDay);</span><br><span class="line"><span class="comment">//获取当前小时数</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">long</span> nowForHours = hourOfDay.getFrom(now);</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间的小时数：&quot;</span> + nowForHours);</span><br><span class="line"><span class="comment">//获取到指定单位的时间大小</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> hoursForGet = now.get(ChronoField.HOUR_OF_DAY);</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间的小时数（get()）：&quot;</span> + hoursForGet);</span><br><span class="line"><span class="comment">//获取到特定单位的时间对比对象 Duration</span></span><br><span class="line"><span class="keyword">final</span> TemporalUnit baseUnit = hourOfDay.getBaseUnit();</span><br><span class="line">System.out.println(baseUnit);</span><br></pre></td></tr></table></figure>
<h3 id="TemporalUnit-ChronoUnit"><a href="#TemporalUnit-ChronoUnit" class="headerlink" title="TemporalUnit/ChronoUnit"></a>TemporalUnit/ChronoUnit</h3><p>也是时间单位，TemporalUnit 是接口，ChronoUnit 则是实现类。和上面的不同的地方在于上面的不能 ChronoField 不能对时间进行对比差值，只能根据指定单位获取时间的大小。</p>
<p>基本操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取一个小时数</span></span><br><span class="line"><span class="keyword">final</span> ChronoUnit chronoUnit = ChronoUnit.MILLIS;</span><br><span class="line">System.out.println(chronoUnit);</span><br><span class="line"><span class="comment">//获取两个时间的差值毫秒数</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime now = LocalDateTime.now();</span><br><span class="line"><span class="keyword">final</span> LocalDateTime localDateTimePlusHourOne = now.plusHours(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">final</span> <span class="keyword">long</span> betweenForMillis = chronoUnit.between(now, localDateTimePlusHourOne);</span><br><span class="line">System.out.println(<span class="string">&quot;相差的毫秒数：&quot;</span> + betweenForMillis);</span><br><span class="line"><span class="comment">//根据指定的单位修改时间也需要使用这个</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime localDateTimePlusMinuteOne = now.plus(<span class="number">1</span>, ChronoUnit.MINUTES);</span><br><span class="line">System.out.println(<span class="string">&quot;一分钟后的时间：&quot;</span> + localDateTimePlusMinuteOne);</span><br></pre></td></tr></table></figure>
<h3 id="DateTimeFormatter"><a href="#DateTimeFormatter" class="headerlink" title="DateTimeFormatter"></a>DateTimeFormatter</h3><p>日期时间格式化类，基本上没什么好说的（标准的格式化一般就足够了，毕竟显示是前端的事情，而标准的格式化确实是国际标准呢）</p>
<p>基本使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取一个标准 iso 日期时间格式化对象</span></span><br><span class="line"><span class="keyword">final</span> DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ISO_DATE_TIME;</span><br><span class="line">System.out.println(dateTimeFormatter);</span><br><span class="line"><span class="comment">//格式化日期时间</span></span><br><span class="line"><span class="keyword">final</span> LocalDateTime now = LocalDateTime.now();</span><br><span class="line">System.out.println(<span class="string">&quot;当前日期时间：&quot;</span> + dateTimeFormatter.format(now));</span><br><span class="line"><span class="comment">//根据自定义的格式格式化时间</span></span><br><span class="line"><span class="keyword">final</span> DateTimeFormatter customDateTimeFormatter = DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy年MM月dd日 hh时mm分ss秒&quot;</span>);</span><br><span class="line">System.out.println(customDateTimeFormatter.format(now));</span><br></pre></td></tr></table></figure>
<h3 id="兼容-Date"><a href="#兼容-Date" class="headerlink" title="兼容 Date"></a>兼容 Date</h3><p>使用新的时间 API 固然很令人舒服，但有时候不得不兼容旧的 Date 类型，这时候如何转换就很重要了呢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> LocalDateTime now = LocalDateTime.now();</span><br><span class="line"><span class="comment">//转换为 Instant（包括时区）</span></span><br><span class="line"><span class="keyword">final</span> Instant instant = now.toInstant(ZoneOffset.UTC);</span><br><span class="line">System.out.println(instant);</span><br><span class="line"><span class="comment">//转换为 Date</span></span><br><span class="line"><span class="keyword">final</span> Date date = Date.from(instant);</span><br><span class="line">System.out.println(<span class="string">&quot;当前时间：&quot;</span> + date);</span><br><span class="line"><span class="comment">//转换为 Instant</span></span><br><span class="line"><span class="keyword">final</span> Instant dateToInstant = date.toInstant();</span><br><span class="line">System.out.println(<span class="string">&quot;两次转换后的时间还是相同的吧？&quot;</span> + dateToInstant.equals(instant));</span><br><span class="line"><span class="comment">//转换为 LocalDateTime</span></span><br><span class="line"><span class="keyword">final</span> ZoneId zoneId = ZoneId.systemDefault();</span><br><span class="line"><span class="keyword">final</span> LocalDateTime toLocalDateTime = LocalDateTime.ofInstant(dateToInstant, zoneId);</span><br><span class="line">System.out.println(<span class="string">&quot;转换后的日期时间：&quot;</span> + toLocalDateTime);</span><br></pre></td></tr></table></figure>
<h2 id="主流框架支持"><a href="#主流框架支持" class="headerlink" title="主流框架支持"></a>主流框架支持</h2><p>现如今大部分的包应该都支持 Java8 时间 API 了吧</p>
<p>例如：</p>
<ul>
<li>Jackson：jackson-datatype-jsr310</li>
<li>Mybatis：mybatis-typehandlers-jsr310</li>
</ul>
<p>那么，关于 Java8 新的时间 API 的使用暂且到这里了，想到什么吾辈再补充啦（=´∇ ｀=）</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/04/18/12d510588aee423d8bd1ac24ecc6925a/" data-id="ckmcqox29000u0kuv3zpp6xoo" data-title="使用 Java8 新的时间 API" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/04/18/09d35ae510984c72bdc5a745c2c3f473/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Java8 函数式功能速查
        
      </div>
    </a>
  
  
    <a href="/2020/04/18/13b0e6026a7942c29c2784508bd77526/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">MongoDB 用户认证及操作</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/" rel="tag">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electron/" rel="tag">electron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grid/" rel="tag">grid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jetbrains/" rel="tag">jetbrains</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/" rel="tag">markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/" rel="tag">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/typescript/" rel="tag">typescript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webstorm/" rel="tag">webstorm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA/" rel="tag">个人</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%AC%E5%8F%B8/" rel="tag">公司</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%91%A8%E6%8A%A5/" rel="tag">周报</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%A3%E5%91%8A/" rel="tag">宣告</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" rel="tag">工程化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E6%BA%90/" rel="tag">开源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%82%E6%AD%A5/" rel="tag">异步</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%85%E6%9B%B4%E6%96%B0/" rel="tag">待更新</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%8F%E9%AA%8C/" rel="tag">经验</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6/" rel="tag">读书</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag">转载</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/css/" style="font-size: 12.14px;">css</a> <a href="/tags/electron/" style="font-size: 15.71px;">electron</a> <a href="/tags/git/" style="font-size: 12.86px;">git</a> <a href="/tags/grid/" style="font-size: 10.71px;">grid</a> <a href="/tags/java/" style="font-size: 19.29px;">java</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/jetbrains/" style="font-size: 12.14px;">jetbrains</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/markdown/" style="font-size: 10.71px;">markdown</a> <a href="/tags/react/" style="font-size: 14.29px;">react</a> <a href="/tags/sql/" style="font-size: 14.29px;">sql</a> <a href="/tags/typescript/" style="font-size: 12.14px;">typescript</a> <a href="/tags/vscode/" style="font-size: 12.86px;">vscode</a> <a href="/tags/vue/" style="font-size: 16.43px;">vue</a> <a href="/tags/webstorm/" style="font-size: 10px;">webstorm</a> <a href="/tags/windows/" style="font-size: 17.14px;">windows</a> <a href="/tags/%E4%B8%AA%E4%BA%BA/" style="font-size: 12.86px;">个人</a> <a href="/tags/%E5%85%AC%E5%8F%B8/" style="font-size: 10px;">公司</a> <a href="/tags/%E5%91%A8%E6%8A%A5/" style="font-size: 10px;">周报</a> <a href="/tags/%E5%AE%A3%E5%91%8A/" style="font-size: 10px;">宣告</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 13.57px;">工具</a> <a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" style="font-size: 17.86px;">工程化</a> <a href="/tags/%E5%BC%80%E6%BA%90/" style="font-size: 10px;">开源</a> <a href="/tags/%E5%BC%82%E6%AD%A5/" style="font-size: 15px;">异步</a> <a href="/tags/%E5%BE%85%E6%9B%B4%E6%96%B0/" style="font-size: 10.71px;">待更新</a> <a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 18.57px;">杂谈</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a> <a href="/tags/%E7%BB%8F%E9%AA%8C/" style="font-size: 11.43px;">经验</a> <a href="/tags/%E8%AF%BB%E4%B9%A6/" style="font-size: 12.14px;">读书</a> <a href="/tags/%E8%BD%AC%E8%BD%BD/" style="font-size: 11.43px;">转载</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/14/8fb2d58463ae4191ac064a76e15bffbd/">2021 第十周</a>
          </li>
        
          <li>
            <a href="/2021/03/12/7e7131c07c984d928ba3fefa7a9cef06/">读书-[颓废与沉默：透视犬儒文化]</a>
          </li>
        
          <li>
            <a href="/2021/03/02/db74e6e5d2444bc3b6e185a7b338bbf6/">electron 开发经验之谈系列-在渲染、主进程间共享数据</a>
          </li>
        
          <li>
            <a href="/2021/02/27/06cb464179cf45c598208534705aae3c/">2020 吾辈在公司推动的前端技术演进</a>
          </li>
        
          <li>
            <a href="/2021/02/23/cd66150d2b86448590fcc9bb2419c0b2/">实践 lerna monorepo</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>