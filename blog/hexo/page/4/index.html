<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-29570a546190499ebc65025840981f6b" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/30/29570a546190499ebc65025840981f6b/" class="article-date">
  <time class="dt-published" datetime="2020-12-30T00:31:33.000Z" itemprop="datePublished">2020-12-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/30/29570a546190499ebc65025840981f6b/">工具类网站</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a href="#%E5%B7%A5%E5%85%B7%E7%B1%BB%E7%BD%91%E7%AB%99">工具类网站</a><ul>
<li><a href="#%E7%BC%96%E7%A8%8B">编程</a><ul>
<li><a href="#netlify%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99%E6%89%98%E7%AE%A1%E5%B9%B3%E5%8F%B0">netlify：静态网站托管平台</a></li>
<li><a href="#cloudflare%E5%8A%A0%E9%80%9F%E5%B9%B6%E4%BF%9D%E6%8A%A4%E7%BD%91%E7%AB%99">cloudflare：加速并保护网站</a></li>
<li><a href="#heroku%E4%BA%91%E7%AB%AF%E7%A8%8B%E5%BA%8F%E6%89%98%E7%AE%A1%E5%B9%B3%E5%8F%B0">heroku：云端程序托管平台</a></li>
<li><a href="#draw%E7%94%BB%E5%9B%BE%E5%B7%A5%E5%85%B7">draw：画图工具</a></li>
<li><a href="#serveo%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F">Serveo：内网穿透</a></li>
<li><a href="#namesilo%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1">namesilo：域名服务</a></li>
<li><a href="#coursera%E5%9C%A8%E7%BA%BF%E6%95%99%E8%82%B2">coursera：在线教育</a></li>
<li><a href="#flaticon%E7%9F%A2%E9%87%8F%E5%9B%BE%E6%A0%87%E5%BA%93">flaticon：矢量图标库</a></li>
</ul>
</li>
<li><a href="#%E9%9D%9E%E7%BC%96%E7%A8%8B">非编程</a><ul>
<li><a href="#google-translate%E8%B0%B7%E6%AD%8C%E7%BF%BB%E8%AF%91">Google Translate：谷歌翻译</a></li>
<li><a href="#inoreaderrss-%E9%98%85%E8%AF%BB%E5%99%A8">inoreader：RSS 阅读器</a></li>
<li><a href="#itellyou%E5%BE%AE%E8%BD%AF%E7%9B%B8%E5%85%B3%E8%B5%84%E6%BA%90%E4%B8%8B%E8%BD%BD">itellyou：微软相关资源下载</a></li>
<li><a href="#gmailgoogle-%E5%AE%B6%E7%9A%84%E9%82%AE%E7%AE%B1%E6%9C%8D%E5%8A%A1">Gmail：Google 家的邮箱服务</a></li>
<li><a href="#smms%E5%85%8D%E8%B4%B9%E7%A8%B3%E5%AE%9A%E7%9A%84%E5%9B%BE%E5%BA%8A">smms：免费稳定的图床</a></li>
<li><a href="#firefox-send%E5%85%8D%E8%B4%B9%E5%AE%89%E5%85%A8%E7%9A%84%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB">Firefox send：免费安全的文件共享</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="编程"><a href="#编程" class="headerlink" title="编程"></a>编程</h2><h3 id="netlify：静态网站托管平台"><a href="#netlify：静态网站托管平台" class="headerlink" title="netlify：静态网站托管平台"></a><a target="_blank" rel="noopener" href="https://www.netlify.com/">netlify</a>：静态网站托管平台</h3><p>可以简单方便的托管自己的静态网站，能够连接到主流的代码托管平台（<a target="_blank" rel="noopener" href="https://github.com/">GitHub</a>, <a target="_blank" rel="noopener" href="https://gitlab.com/">GitLab</a>, <a target="_blank" rel="noopener" href="https://bitbucket.org/">Bitbucket</a>），支持自动在线部署网站，可以免费同时部署多个网站（同一域名下）。相比于 GitHub Page 而言有着更加强大的功能</p>
<p>下面是 GitHub 和 Netlify 的对比</p>
<table>
<thead>
<tr>
<th>对比</th>
<th>GitHub</th>
<th>Netlify</th>
</tr>
</thead>
<tbody><tr>
<td>价格</td>
<td>免费</td>
<td>免费</td>
</tr>
<tr>
<td>构建限制</td>
<td>每小时 10 次</td>
<td>每分钟 3 次</td>
</tr>
<tr>
<td>使用 HTTPS 的自定义域</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>单击 回滚</td>
<td>没有</td>
<td>是</td>
</tr>
<tr>
<td>资产优化</td>
<td>没有</td>
<td>是</td>
</tr>
<tr>
<td>表格处理</td>
<td>没有</td>
<td>是</td>
</tr>
<tr>
<td>部署预览</td>
<td>没有</td>
<td>是</td>
</tr>
<tr>
<td>持续部署</td>
<td>没有</td>
<td>是</td>
</tr>
<tr>
<td>自定义重写和重定向</td>
<td>没有</td>
<td>是</td>
</tr>
<tr>
<td>兼容所有静态站点生成器</td>
<td>没有</td>
<td>是</td>
</tr>
<tr>
<td>预呈现</td>
<td>没有</td>
<td>是</td>
</tr>
<tr>
<td>拆分测试</td>
<td>没有</td>
<td>是</td>
</tr>
<tr>
<td>Lambda 函数集成</td>
<td>没有</td>
<td>是</td>
</tr>
</tbody></table>
<h3 id="cloudflare：加速并保护网站"><a href="#cloudflare：加速并保护网站" class="headerlink" title="cloudflare：加速并保护网站"></a><a target="_blank" rel="noopener" href="https://www.cloudflare.com/">cloudflare</a>：加速并保护网站</h3><p>配合上面的 <a href="#netlifyhttpswwwnetlifycom%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99%E6%89%98%E7%AE%A1%E5%B9%B3%E5%8F%B0">netlify</a> 一起使用，对于吾辈而言主要用到了下面的功能：</p>
<ul>
<li>快速刷新域名 DNS 缓存（几分钟内在网络上完成更新）</li>
<li>为网站加上 HTTPS 前缀</li>
<li>自动将 HTTP 请求转发到 HTTPS</li>
<li>使用 CDN 加速网站</li>
</ul>
<h3 id="heroku：云端程序托管平台"><a href="#heroku：云端程序托管平台" class="headerlink" title="heroku：云端程序托管平台"></a><a target="_blank" rel="noopener" href="https://www.heroku.com/">heroku</a>：云端程序托管平台</h3><p>上面说过的 <a href="#netlifyhttpswwwnetlifycom%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99%E6%89%98%E7%AE%A1%E5%B9%B3%E5%8F%B0">netlify</a> 可以托管静态网站，但 heroku 能托管一切！不仅仅是前端，<code>Node.js, Ruby, Python, Java, PHP, Go, Scala, Clojure</code> 都不在话下。那么，为什么吾辈没有第一个就推荐它呢？因为 heroku 免费帐户的限制比较大。。。</p>
<ul>
<li>未认证信用卡的账户每个月只有 500 个小时可用时间</li>
<li>未认证信用卡的账户无法自定义域名</li>
<li>虽然能够托管多语言的程序，然而并非指程序依赖的服务也存在，例如 <code>MySQL，Redis</code> 等等</li>
</ul>
<p>但即便有上面的这些缺点，对于开源的后端程序用于展示的话还是相当不错的。而且，我们可以利用它免费搭建 <code>Shadowsocks</code> 服务，而且速度也不算慢！</p>
<h3 id="draw：画图工具"><a href="#draw：画图工具" class="headerlink" title="draw：画图工具"></a><a target="_blank" rel="noopener" href="https://www.draw.io/">draw</a>：画图工具</h3><p>开源免费的 Web 版的在线画图工具，方便而快捷，支持多种格式导出/保存/导入。即时保存，即使浏览器崩溃也没有问题。</p>
<p>功能列表</p>
<ul>
<li>基础功能：支持任意拖动图形，自带对其/微调，可以进行样式编辑，在任意处插入文本</li>
<li>便签：将一个或多个可复用的内容保存为便签，下次直接拖动出来就好了</li>
<li>第三方保存：Google Drive, OneDrive, Dropbox, GitHub, Trello, 电脑或手机设备, 浏览器</li>
<li>多格式导出：PNG, JPEG, SVG, PDF, VSDX, HTML, XML, URL 地址</li>
</ul>
<h3 id="Serveo：内网穿透"><a href="#Serveo：内网穿透" class="headerlink" title="Serveo：内网穿透"></a><a target="_blank" rel="noopener" href="https://serveo.net/">Serveo</a>：内网穿透</h3><p>用于在微信开发时，微信公众号需要公网 <strong>ip + 80</strong> 端口的问题，可以实现远程访问到本地部署的项目。</p>
<h3 id="namesilo：域名服务"><a href="#namesilo：域名服务" class="headerlink" title="namesilo：域名服务"></a><a target="_blank" rel="noopener" href="https://www.namesilo.com/?rid=ea90147sn">namesilo</a>：域名服务</h3><p>如果你需要建立个人网站，或者搭建个人博客的话。那域名几乎是必不可少的。毕竟，谁也不想记住一个 IP 地址，而有一个更有标识性的域名岂非更好呢？</p>
<blockquote>
<p>注：之所以不使用国内的 <a target="_blank" rel="noopener" href="https://wanwang.aliyun.com/">万网</a> 之类的是因为国内的域名有可能被封/被屏蔽，原因很多请参考 <a target="_blank" rel="noopener" href="https://www.williamlong.info/archives/1654.html">警告——不要在国内注册和使用 CN 域名</a>，本质上在国内注册的域名所有权不属于你！</p>
</blockquote>
<h3 id="coursera：在线教育"><a href="#coursera：在线教育" class="headerlink" title="coursera：在线教育"></a><a target="_blank" rel="noopener" href="https://www.coursera.org/">coursera</a>：在线教育</h3><p>国外非常流行的在线教育网站，有着非常多的在线课程可以学习，而且学完之后还有证书可拿（免费结业证书/付费认证证书）。</p>
<blockquote>
<p>附：大部分课程都是英语，当初没学好英语真是一生的痛呀！</p>
</blockquote>
<h3 id="flaticon：矢量图标库"><a href="#flaticon：矢量图标库" class="headerlink" title="flaticon：矢量图标库"></a><a target="_blank" rel="noopener" href="https://www.flaticon.com/">flaticon</a>：矢量图标库</h3><p>免费的在线图标库，目前大约有 1494000 个图标了。只所以不推荐阿里的矢量图标库 <a target="_blank" rel="noopener" href="https://www.iconfont.cn/">iconfont</a> 是因为。。。嗯，你懂的，国人总喜欢 <strong>抄袭</strong> 而非 <strong>原创</strong>（某企鹅以此成家），所以设计/创新相关的还是使用国外的更好一点呢！</p>
<h2 id="非编程"><a href="#非编程" class="headerlink" title="非编程"></a>非编程</h2><h3 id="Google-Translate：谷歌翻译"><a href="#Google-Translate：谷歌翻译" class="headerlink" title="Google Translate：谷歌翻译"></a><a target="_blank" rel="noopener" href="https://translate.google.com/">Google Translate</a>：谷歌翻译</h3><p>Google 出品的翻译网站，支持的语言非常多，对于中文/英文的支持也很不错呢（信仰）</p>
<h3 id="inoreader：RSS-阅读器"><a href="#inoreader：RSS-阅读器" class="headerlink" title="inoreader：RSS 阅读器"></a><a target="_blank" rel="noopener" href="https://www.inoreader.com/">inoreader</a>：RSS 阅读器</h3><p>全平台的 RSS 阅读器，与之相似的只有 feedly 了吧。用来订阅/管理 RSS 源，阅读起来也很方便，基本上免费的套餐便是足够个人使用了。</p>
<h3 id="itellyou：微软相关资源下载"><a href="#itellyou：微软相关资源下载" class="headerlink" title="itellyou：微软相关资源下载"></a><a target="_blank" rel="noopener" href="https://msdn.itellyou.cn/">itellyou</a>：微软相关资源下载</h3><p>方便下载各种微软的相关资源，提供了直接的下载链接（_ed2k_），例如 _Windows 系统<em>，_VS IDE_，</em>.NET Framework_。</p>
<h3 id="Gmail：Google-家的邮箱服务"><a href="#Gmail：Google-家的邮箱服务" class="headerlink" title="Gmail：Google 家的邮箱服务"></a><a target="_blank" rel="noopener" href="https://mail.google.com/">Gmail</a>：Google 家的邮箱服务</h3><p>Google 出品，必属精品（#大雾）目前而言最好的邮箱。Web 版本提供的功能与体验是其他国内邮箱根本无法相提并论的（QQ/163 之流），配合 <a target="_blank" rel="noopener" href="https://jasonsavard.com/zh-CN/Checker-Plus-for-Gmail">Chrome 插件</a> 与 <a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.google.android.gm&hl=zh_CN">Gmail For Android</a> 风味更佳。</p>
<blockquote>
<p>附：Gmail Web 版必须使用梯子，但服务本身并未受到影响，与其他邮箱互通邮件一切正常。</p>
</blockquote>
<h3 id="smms：免费稳定的图床"><a href="#smms：免费稳定的图床" class="headerlink" title="smms：免费稳定的图床"></a><a target="_blank" rel="noopener" href="https://sm.ms/">smms</a>：免费稳定的图床</h3><p>一个简单好用的图床，不需要注册/登录，直接就可以上传图片获取外链了，提供 API 可供开发/嵌入到第三方客户端。</p>
<h3 id="Firefox-send：免费安全的文件共享"><a href="#Firefox-send：免费安全的文件共享" class="headerlink" title="Firefox send：免费安全的文件共享"></a><a target="_blank" rel="noopener" href="https://send.firefox.com/">Firefox send</a>：免费安全的文件共享</h3><blockquote>
<p>说到 Mozilla 泥萌可能很多人不太清楚，但 Firefox 却是大名鼎鼎，而 Mozilla 正是 Firefox 的母公司！</p>
</blockquote>
<p>Mozilla 家推出的所有现代浏览器都可以使用的文件共享服务。<br>主要特性</p>
<ul>
<li>最大支持 1G</li>
<li>24 小时后自动删除</li>
<li>加密的共享链接</li>
<li>支持限制下载次数</li>
<li>支持手动失效</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/30/29570a546190499ebc65025840981f6b/" data-id="ckmcqox2p001y0kuvhzy2emww" data-title="工具类网站" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vue/" rel="tag">vue</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-744e094835954a57accd6edce4feeb93" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/29/744e094835954a57accd6edce4feeb93/" class="article-date">
  <time class="dt-published" datetime="2020-12-29T00:23:46.000Z" itemprop="datePublished">2020-12-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/29/744e094835954a57accd6edce4feeb93/">博客迁移</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>注：可能出现博客文章的顺序完全混乱，但随着笔记的修正将逐渐恢复正确的顺序。</p>
</blockquote>
<p>这个博客正在从 github + hexo 迁移至 joplin + hexo，将 joplin 笔记作为唯一数据源，结合 hexo 生成一个网站。</p>
<hr>
<p>下面是关于 <a target="_blank" rel="noopener" href="http://github.com/rxliuli/joplin-blog">joplin-blog 项目</a> 的介绍</p>
<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><p>你是否和吾辈一样烦恼同时维护笔记和博客的同步麻烦，如果你使用 joplin 作为笔记工具，而使用 hexo 作为博客生成器的话，你可以选择这个工具来连接它们。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>方式 1</p>
<ol>
<li> 添加配置文件 <code>.joplin-blog.json</code>（具体配置参考 <a href="#%E9%85%8D%E7%BD%AE">配置</a>）</li>
<li> 使用命令导出笔记为博客 <code>npx joplin-blog</code></li>
</ol>
<p>方式 2</p>
<ol>
<li> 在命令行导航到 hexo 博客目录</li>
<li> 添加依赖 <code>yarn add -D joplin-blog</code></li>
<li> 添加配置文件 <code>.joplin-blog.json</code>（具体配置参考 <a href="#%E9%85%8D%E7%BD%AE">配置</a>）</li>
<li> 添加一个 npm script 脚本文件 <code>&quot;imp&quot;: &quot;joplin-hexo&quot;</code></li>
<li> 运行命令 <code>yarn imp</code></li>
<li> 可以看到 <code>source/_posts</code> 目录下已经包含了所有导出的笔记</li>
</ol>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/rxliuli/joplin-blog/tree/master/tutorials/hexo-example">hexo</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/rxliuli/joplin-blog/tree/master/tutorials/vuepress-example">vuepress</a></li>
</ul>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>公共</p>
<table>
<thead>
<tr>
<th>配置</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>type</code></td>
<td><code>hexo/vuepress</code></td>
<td>集成博客的类型</td>
</tr>
<tr>
<td><code>rootPath</code></td>
<td><code>string</code></td>
<td>hexo/vuepress 目录，一般应该为 <code>.</code></td>
</tr>
<tr>
<td><code>joplinProfilePath</code></td>
<td><code>string</code></td>
<td>joplin 个人文件夹</td>
</tr>
<tr>
<td><code>token</code></td>
<td><code>string</code></td>
<td>joplin web service 的 token</td>
</tr>
<tr>
<td><code>port</code></td>
<td><code>number</code></td>
<td>joplin web service 的端口</td>
</tr>
<tr>
<td><code>tag</code></td>
<td><code>string</code></td>
<td>joplin 的博客标签</td>
</tr>
</tbody></table>
<p>hexo</p>
<table>
<thead>
<tr>
<th>配置</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>stickyTopIdList</code></td>
<td><code>string[]</code></td>
<td>置顶的笔记 id（仅在 fluid 主题下生效）</td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/29/744e094835954a57accd6edce4feeb93/" data-id="ckmcqox3p004u0kuvaqqmhcjl" data-title="博客迁移" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-59cc4e212f694ea78a27cda6e6770974" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/28/59cc4e212f694ea78a27cda6e6770974/" class="article-date">
  <time class="dt-published" datetime="2020-12-28T01:48:38.000Z" itemprop="datePublished">2020-12-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/28/59cc4e212f694ea78a27cda6e6770974/">TypeScript 类型编程</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>TypeScript 改变了吾辈对于类型系统的认知，它强大的类型系统使得类型本身也是可编程的。</p>
</blockquote>
<p>最近 TypeScript 更新了一个大版本 v4，新增了一些非常强大的特性，让之前难以做到的事情也能够实现了。</p>
<ul>
<li>模板字符串类型</li>
<li>递归类型</li>
</ul>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><blockquote>
<p>参考：<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-1.html">TypeScript 4.1</a></p>
</blockquote>
<h3 id="模板字符串类型"><a href="#模板字符串类型" class="headerlink" title="模板字符串类型"></a>模板字符串类型</h3><p>尤其适合在 CSS Properties 相关的类型定义中使用，例如 css 的 <code>width</code>，就可以使用模板字符串进行检查避免低级错误。</p>
<p>之前</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Width = <span class="built_in">number</span> | <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">const</span> i: Width = <span class="string">&quot;1px&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> i2: Width = <span class="string">&quot;1px2&quot;</span>; <span class="comment">// 不会报错</span></span><br></pre></td></tr></table></figure>
<p>现在</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Unit = <span class="string">&quot;px&quot;</span> | <span class="string">&quot;%&quot;</span> | <span class="string">&quot;em&quot;</span> | <span class="string">&quot;rem&quot;</span>;</span><br><span class="line"><span class="keyword">type</span> Width = <span class="built_in">number</span> | <span class="string">`<span class="subst">$&#123;<span class="built_in">number</span>&#125;</span><span class="subst">$&#123;Unit&#125;</span>`</span>;</span><br><span class="line"><span class="keyword">const</span> i: Width = <span class="string">&quot;1px&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> i2: Width = <span class="string">&quot;1px2&quot;</span>; <span class="comment">// TS2322: Type &#x27;&quot;1px2&quot;&#x27; is not assignable to type &#x27;Width&#x27;.</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>该特性在 Grid 组件进行了实用，能够避免一些低级错误。</p>
</blockquote>
<h3 id="递归类型"><a href="#递归类型" class="headerlink" title="递归类型"></a>递归类型</h3><p>事实上，递归类型的需求由来已久。例如典型的 <code>Array.prototype.flat</code> 函数的类型定义，或是函数式中部分应用函数的类型定义。</p>
<p>下面是一个将嵌套数组亚平的函数的类型定义示例（来自 TypeScript 官网）</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ElementType&lt;T&gt; = T <span class="keyword">extends</span> ReadonlyArray&lt;infer U&gt; ? ElementType&lt;U&gt; : T;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepFlatten</span>&lt;<span class="title">T</span> <span class="title">extends</span> <span class="title">readonly</span> <span class="title">unknown</span>[]&gt;(<span class="params">x: T</span>): <span class="title">ElementType</span>&lt;<span class="title">T</span>&gt;[] </span>&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="string">&quot;not implemented&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// All of these return the type &#x27;number[]&#x27;:</span></span><br><span class="line">deepFlatten([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line">deepFlatten([[<span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>]]);</span><br><span class="line">deepFlatten([[<span class="number">1</span>], [[<span class="number">2</span>]], [[[<span class="number">3</span>]]]]);</span><br></pre></td></tr></table></figure>
<h2 id="实际的使用场景"><a href="#实际的使用场景" class="headerlink" title="实际的使用场景"></a>实际的使用场景</h2><h3 id="在-i18next-中根据-key-获取翻译字符串"><a href="#在-i18next-中根据-key-获取翻译字符串" class="headerlink" title="在 i18next 中根据 key 获取翻译字符串"></a>在 i18next 中根据 key 获取翻译字符串</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/a/58308279/8409380">i18next 的类型定义</a></p>
</blockquote>
<p>最近遇到了通过 i18n 框架获取翻译文本的需求，其中翻译文本通过一个对象的形式定义，所以吾辈就需要一种能够根据 key 获取到类型的方法。</p>
<p>需要支持以下情况</p>
<ul>
<li>根据 key 获取对应的文本</li>
<li>根据 key 深层获取文本</li>
<li>根据 key 获取文本并进行参数注入</li>
</ul>
<p>下面是吾辈对 i18next 的封装</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zhCN <span class="keyword">from</span> <span class="string">&quot;../i18n/zhCN&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> en <span class="keyword">from</span> <span class="string">&quot;../i18n/en&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> i18next, &#123; TOptions &#125; <span class="keyword">from</span> <span class="string">&quot;i18next&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//region 类型定义</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// returns the same string literal T, if props match, else never</span></span><br><span class="line"><span class="keyword">type</span> CheckDictString&lt;T <span class="keyword">extends</span> <span class="built_in">string</span>, O&gt; = T <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;infer A&#125;</span>.<span class="subst">$&#123;infer B&#125;</span>`</span></span><br><span class="line">  ? A <span class="keyword">extends</span> keyof O</span><br><span class="line">    ? <span class="string">`<span class="subst">$&#123;A&#125;</span>.<span class="subst">$&#123;Extract&lt;CheckDictString&lt;B, O[A]&gt;, <span class="built_in">string</span>&gt;&#125;</span>`</span></span><br><span class="line">    : <span class="built_in">never</span></span><br><span class="line">  : T <span class="keyword">extends</span> keyof O</span><br><span class="line">  ? T</span><br><span class="line">  : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// returns the property value from object O given property path T</span></span><br><span class="line"><span class="keyword">type</span> GetDictValue&lt;T <span class="keyword">extends</span> <span class="built_in">string</span>, O&gt; = T <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;infer A&#125;</span>.<span class="subst">$&#123;infer B&#125;</span>`</span></span><br><span class="line">  ? A <span class="keyword">extends</span> keyof O</span><br><span class="line">    ? GetDictValue&lt;B, O[A]&gt;</span><br><span class="line">    : <span class="built_in">never</span></span><br><span class="line">  : T <span class="keyword">extends</span> keyof O</span><br><span class="line">  ? O[T]</span><br><span class="line">  : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// retrieves all variable placeholder names as tuple</span></span><br><span class="line"><span class="keyword">type</span> Keys&lt;S <span class="keyword">extends</span> <span class="built_in">string</span>&gt; = S <span class="keyword">extends</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  ? []</span><br><span class="line">  : S <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;infer _&#125;</span>&#123;&#123;<span class="subst">$&#123;infer B&#125;</span>&#125;&#125;<span class="subst">$&#123;infer C&#125;</span>`</span></span><br><span class="line">  ? [B, ...Keys&lt;C&gt;]</span><br><span class="line">  : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// substitutes placeholder variables with input values</span></span><br><span class="line"><span class="keyword">type</span> Interpolate&lt;</span><br><span class="line">  S <span class="keyword">extends</span> <span class="built_in">string</span>,</span><br><span class="line">  I <span class="keyword">extends</span> Record&lt;Keys&lt;S&gt;[<span class="built_in">number</span>], <span class="built_in">string</span>&gt;</span><br><span class="line">&gt; = S <span class="keyword">extends</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  ? <span class="string">&quot;&quot;</span></span><br><span class="line">  : S <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;infer A&#125;</span>&#123;&#123;<span class="subst">$&#123;infer B&#125;</span>&#125;&#125;<span class="subst">$&#123;infer C&#125;</span>`</span></span><br><span class="line">  ? <span class="string">`<span class="subst">$&#123;A&#125;</span><span class="subst">$&#123;I[Extract&lt;B, keyof I&gt;]&#125;</span><span class="subst">$&#123;Interpolate&lt;C, I&gt;&#125;</span>`</span></span><br><span class="line">  : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//endregion</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Dict = <span class="keyword">typeof</span> zhCN | <span class="keyword">typeof</span> en;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="built_in">enum</span> LanguageEnum &#123;</span><br><span class="line">  ZhCN = <span class="string">&quot;zhCN&quot;</span>,</span><br><span class="line">  En = <span class="string">&quot;en&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">I18nLoader</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 加载国际化</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">load</span>(<span class="params">language: LanguageEnum</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> i18next.init(&#123;</span><br><span class="line">      lng: language,</span><br><span class="line">      resources: &#123;</span><br><span class="line">        en: &#123;</span><br><span class="line">          translation: en,</span><br><span class="line">        &#125;,</span><br><span class="line">        zhCN: &#123;</span><br><span class="line">          translation: zhCN,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据 key 获取翻译的文本</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="variable">key</span></span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  getText&lt;K <span class="keyword">extends</span> <span class="built_in">string</span>&gt;(</span><br><span class="line">    key: keyof Dict | (K &amp; CheckDictString&lt;K, Dict&gt;)</span><br><span class="line">  ): GetDictValue&lt;K, Dict&gt;;</span><br><span class="line">  getText&lt;</span><br><span class="line">    D <span class="keyword">extends</span> Dict &amp; Record&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;,</span><br><span class="line">    K <span class="keyword">extends</span> keyof D,</span><br><span class="line">    I <span class="keyword">extends</span> Record&lt;Keys&lt;D[K]&gt;[<span class="built_in">number</span>], <span class="built_in">string</span>&gt;</span><br><span class="line">  &gt;(k: K, <span class="attr">args</span>: I): Interpolate&lt;D[K], I&gt;;</span><br><span class="line">  getText&lt;K <span class="keyword">extends</span> <span class="built_in">string</span>&gt;(</span><br><span class="line">    key: keyof Dict | (K &amp; CheckDictString&lt;K, Dict&gt;),</span><br><span class="line">    args?: TOptions</span><br><span class="line">  ): GetDictValue&lt;K, Dict&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> i18next.t(key, args);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用起来很简单</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> i18nLoader = <span class="keyword">new</span> I18nLoader();</span><br><span class="line"><span class="keyword">await</span> i18nLoader.load(LanguageEnum.ZhCN);</span><br><span class="line"><span class="built_in">console</span>.log(i18nLoader.getText(<span class="string">&quot;hello&quot;</span>)); <span class="comment">// 你好</span></span><br></pre></td></tr></table></figure>
<p>接下来，我们分析以下 <code>CheckDictString</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> CheckDictString&lt;T <span class="keyword">extends</span> <span class="built_in">string</span>, O&gt; = T <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;infer A&#125;</span>.<span class="subst">$&#123;infer B&#125;</span>`</span></span><br><span class="line">  ? A <span class="keyword">extends</span> keyof O</span><br><span class="line">    ? <span class="string">`<span class="subst">$&#123;A&#125;</span>.<span class="subst">$&#123;Extract&lt;CheckDictString&lt;B, O[A]&gt;, <span class="built_in">string</span>&gt;&#125;</span>`</span></span><br><span class="line">    : <span class="built_in">never</span></span><br><span class="line">  : T <span class="keyword">extends</span> keyof O</span><br><span class="line">  ? T</span><br><span class="line">  : <span class="built_in">never</span>;</span><br></pre></td></tr></table></figure>
<ol>
<li> 传入泛型参数 <code>T</code> 和 <code>O</code>，<code>T</code> 必须继承自 <code>string</code></li>
<li>判断 <code>T</code> 是否继承自 <code>$&#123;infer A&#125;.$&#123;infer B&#125;</code>，即判断 <code>T</code> 是否包含 <code>.</code>，并解构得到 <code>A</code>（第一个 <code>.</code> 之前）,<code>B</code>（第一个 <code>.</code> 之后，可能还包含 <code>.</code>）<ol>
<li>如果是，则继续判断 <code>A</code> 是否为传入对象的字段<ol>
<li> 如果是，则继续递归检查 <code>B</code> 是否为 <code>O[A]</code> 的一个字段</li>
<li> 否则，返回 <code>never</code></li>
</ol>
</li>
<li>否则，则判断 <code>T</code> 是否是 <code>O</code> 的字段<ol>
<li> 如果是，则返回 <code>T</code></li>
<li> 否则，返回 <code>never</code></li>
</ol>
</li>
</ol>
</li>
</ol>
<p>可以看到，如果检查出现错误，则返回 <code>never</code>，但我们传入的 <code>string</code> 是不能合并为 <code>never</code> 的，这将会导致 ts 类型检查出错（其它的类型基本上也是一样的推导方式）。</p>
<hr>
<p>附录</p>
<p>虽然看起来不错，那么这个类型是否满足我们简化 i18next 使用的需求呢？<br>实际上没有。即便有如此强大的类型系统，但它仍然不足以满足特别灵活的需求。实际使用时仍发现以下问题：</p>
<ul>
<li>嵌套对象的参数注入没有进行检查</li>
<li>参数注入的翻译文本没有提示注入参数</li>
</ul>
<p>解决方案有两个方向</p>
<ul>
<li>linter rule</li>
<li>code generate</li>
</ul>
<p>下面是一个简单的对比</p>
<table>
<thead>
<tr>
<th>分类</th>
<th>typescript</th>
<th>linter rule</th>
<th>code generate</th>
</tr>
</thead>
<tbody><tr>
<td>使用</td>
<td>直接使用</td>
<td>通过 eslint 插件</td>
<td>通过 cli 命令行</td>
</tr>
<tr>
<td>复杂度</td>
<td>一般（不用了解 <code>ast</code>）</td>
<td>高</td>
<td>较高</td>
</tr>
<tr>
<td>适用场景</td>
<td>绝大多数场景</td>
<td>容易编写的少量代码的检查</td>
<td>大量重复可自动化生成的代码</td>
</tr>
</tbody></table>
<h3 id="使用类型系统解析-json-字符串（好玩性质）"><a href="#使用类型系统解析-json-字符串（好玩性质）" class="headerlink" title="使用类型系统解析 json 字符串（好玩性质）"></a>使用类型系统解析 json 字符串（好玩性质）</h3><p><a target="_blank" rel="noopener" href="https://twitter.com/buildsghost/status/1301976526603206657">twitter 上</a> 甚至有人使用 TypeScript 的模板字符串和递归类型解析了 json 字符串。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ParserError&lt;T <span class="keyword">extends</span> <span class="built_in">string</span>&gt; = &#123; <span class="attr">error</span>: <span class="literal">true</span> &#125; &amp; T;</span><br><span class="line"><span class="keyword">type</span> EatWhitespace&lt;State <span class="keyword">extends</span> <span class="built_in">string</span>&gt; = <span class="built_in">string</span> <span class="keyword">extends</span> State</span><br><span class="line">  ? ParserError&lt;<span class="string">&quot;EatWhitespace got generic string type&quot;</span>&gt;</span><br><span class="line">  : State <span class="keyword">extends</span> <span class="string">` <span class="subst">$&#123;infer State&#125;</span>`</span> | <span class="string">`\n<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">  ? EatWhitespace&lt;State&gt;</span><br><span class="line">  : State;</span><br><span class="line"><span class="keyword">type</span> AddKeyValue&lt;</span><br><span class="line">  Memo <span class="keyword">extends</span> Record&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;,</span><br><span class="line">  Key <span class="keyword">extends</span> <span class="built_in">string</span>,</span><br><span class="line">  Value <span class="keyword">extends</span> <span class="built_in">any</span></span><br><span class="line">&gt; = Memo &amp; &#123; [K <span class="keyword">in</span> Key]: Value &#125;;</span><br><span class="line"><span class="keyword">type</span> ParseJsonObject&lt;</span><br><span class="line">  State <span class="keyword">extends</span> <span class="built_in">string</span>,</span><br><span class="line">  Memo <span class="keyword">extends</span> Record&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt; = &#123;&#125;</span><br><span class="line">&gt; = <span class="built_in">string</span> <span class="keyword">extends</span> State</span><br><span class="line">  ? ParserError&lt;<span class="string">&quot;ParseJsonObject got generic string type&quot;</span>&gt;</span><br><span class="line">  : EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`&#125;<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">  ? [Memo, State]</span><br><span class="line">  : EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`&quot;<span class="subst">$&#123;infer Key&#125;</span>&quot;<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">  ? EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`:<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">    ? ParseJsonValue&lt;State&gt; <span class="keyword">extends</span> [infer Value, <span class="string">`<span class="subst">$&#123;infer State&#125;</span>`</span>]</span><br><span class="line">      ? EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`,<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">        ? ParseJsonObject&lt;State, AddKeyValue&lt;Memo, Key, Value&gt;&gt;</span><br><span class="line">        : EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`&#125;<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">        ? [AddKeyValue&lt;Memo, Key, Value&gt;, State]</span><br><span class="line">        : ParserError&lt;<span class="string">`ParseJsonObject received unexpected token: <span class="subst">$&#123;State&#125;</span>`</span>&gt;</span><br><span class="line">      : ParserError&lt;<span class="string">`ParseJsonValue returned unexpected value for: <span class="subst">$&#123;State&#125;</span>`</span>&gt;</span><br><span class="line">    : ParserError&lt;<span class="string">`ParseJsonObject received unexpected token: <span class="subst">$&#123;State&#125;</span>`</span>&gt;</span><br><span class="line">  : ParserError&lt;<span class="string">`ParseJsonObject received unexpected token: <span class="subst">$&#123;State&#125;</span>`</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> ParseJsonArray&lt;</span><br><span class="line">  State <span class="keyword">extends</span> <span class="built_in">string</span>,</span><br><span class="line">  Memo <span class="keyword">extends</span> <span class="built_in">any</span>[] = []</span><br><span class="line">&gt; = <span class="built_in">string</span> <span class="keyword">extends</span> State</span><br><span class="line">  ? ParserError&lt;<span class="string">&quot;ParseJsonArray got generic string type&quot;</span>&gt;</span><br><span class="line">  : EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`]<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">  ? [Memo, State]</span><br><span class="line">  : ParseJsonValue&lt;State&gt; <span class="keyword">extends</span> [infer Value, <span class="string">`<span class="subst">$&#123;infer State&#125;</span>`</span>]</span><br><span class="line">  ? EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`,<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">    ? ParseJsonArray&lt;EatWhitespace&lt;State&gt;, [...Memo, Value]&gt;</span><br><span class="line">    : EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`]<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">    ? [[...Memo, Value], State]</span><br><span class="line">    : ParserError&lt;<span class="string">`ParseJsonArray received unexpected token: <span class="subst">$&#123;State&#125;</span>`</span>&gt;</span><br><span class="line">  : ParserError&lt;<span class="string">`ParseJsonValue returned unexpected value for: <span class="subst">$&#123;State&#125;</span>`</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> ParseJsonValue&lt;State <span class="keyword">extends</span> <span class="built_in">string</span>&gt; = <span class="built_in">string</span> <span class="keyword">extends</span> State</span><br><span class="line">  ? ParserError&lt;<span class="string">&quot;ParseJsonValue got generic string type&quot;</span>&gt;</span><br><span class="line">  : EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`null<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">  ? [<span class="literal">null</span>, State]</span><br><span class="line">  : EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`&quot;<span class="subst">$&#123;infer Value&#125;</span>&quot;<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">  ? [Value, State]</span><br><span class="line">  : EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`[<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">  ? ParseJsonArray&lt;State&gt;</span><br><span class="line">  : EatWhitespace&lt;State&gt; <span class="keyword">extends</span> <span class="string">`&#123;<span class="subst">$&#123;infer State&#125;</span>`</span></span><br><span class="line">  ? ParseJsonObject&lt;State&gt;</span><br><span class="line">  : ParserError&lt;<span class="string">`ParseJsonValue received unexpected token: <span class="subst">$&#123;State&#125;</span>`</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> ParseJson&lt;T <span class="keyword">extends</span> <span class="built_in">string</span>&gt; = ParseJsonValue&lt;T&gt; <span class="keyword">extends</span> infer Result</span><br><span class="line">  ? Result <span class="keyword">extends</span> [infer Value, <span class="built_in">string</span>]</span><br><span class="line">    ? Value</span><br><span class="line">    : Result <span class="keyword">extends</span> ParserError&lt;<span class="built_in">any</span>&gt;</span><br><span class="line">    ? Result</span><br><span class="line">    : ParserError&lt;<span class="string">&quot;ParseJsonValue returned unexpected Result&quot;</span>&gt;</span><br><span class="line">  : ParserError&lt;<span class="string">&quot;ParseJsonValue returned uninferrable Result&quot;</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Json = ParseJson&lt;<span class="string">&#x27;&#123; &quot;key1&quot;: [&quot;value1&quot;, null], &quot;key2&quot;: &quot;value2&quot; &#125;&#x27;</span>&gt;; <span class="comment">// type Json = &#123; key1: [&quot;value1&quot;, null]; &#125; &amp; &#123; key2: &quot;value2&quot;; &#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>我想后端语言（Java/GoLang）至今也没有出现如此复杂的类型定义。</p>
</blockquote>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>虽然 TypeScript 的类型系统已经如此强大，但它并非没有局限性，像在上面的 <a href="#%E5%9C%A8-i18next-%E4%B8%AD%E6%A0%B9%E6%8D%AE-key-%E8%8E%B7%E5%8F%96%E7%BF%BB%E8%AF%91%E5%AD%97%E7%AC%A6%E4%B8%B2">在 i18next 中根据 key 获取翻译字符串</a> 便是一例。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/28/59cc4e212f694ea78a27cda6e6770974/" data-id="ckmcqox3e003w0kuv0t5002y7" data-title="TypeScript 类型编程" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/typescript/" rel="tag">typescript</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-76072311817b4c1985ab5746e8f91d87" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/25/76072311817b4c1985ab5746e8f91d87/" class="article-date">
  <time class="dt-published" datetime="2020-12-25T01:06:03.000Z" itemprop="datePublished">2020-12-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/25/76072311817b4c1985ab5746e8f91d87/">electron 开发经验之谈系列-常见问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="突然之间-electron-就不能启动了"><a href="#突然之间-electron-就不能启动了" class="headerlink" title="突然之间 electron 就不能启动了"></a>突然之间 electron 就不能启动了</h2><p>删除 node_modules 重新 yarn 看看？</p>
<h2 id="打包之后的程序页面空白"><a href="#打包之后的程序页面空白" class="headerlink" title="打包之后的程序页面空白"></a>打包之后的程序页面空白</h2><p>实际上是 electron 无法正常加载页面，原因很多</p>
<ol>
<li> 路径问题，解压 asar 查看实际路径（<code>main.js</code> 中 <code>loadUrl</code> 的路径是否正确）</li>
<li> react router 仅支持 hash 模式</li>
<li> 在从文件系统中读取 html 文件时不能使用 <code>#</code> 指定路由，参考: <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/55715384s">https://stackoverflow.com/questions/55715384s</a></li>
</ol>
<blockquote>
<p>asar 文件一般在 _win-unpacked/:/app_，参考: <a target="_blank" rel="noopener" href="https://github.com/electron/asar">https://github.com/electron/asar</a></p>
</blockquote>
<h2 id="electron-程序命令行输出中文乱码"><a href="#electron-程序命令行输出中文乱码" class="headerlink" title="electron 程序命令行输出中文乱码"></a>electron 程序命令行输出中文乱码</h2><p>在运行命令前首先运行 <code>chcp 65001</code> 修改活动代码页编号，参考：<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/57131654">Using UTF-8 Encoding (CHCP 65001) in Command Prompt / Windows Powershell (Windows 10)</a></p>
<h2 id="如何不打包成压缩格式-asar"><a href="#如何不打包成压缩格式-asar" class="headerlink" title="如何不打包成压缩格式 asar"></a>如何不打包成压缩格式 asar</h2><p>配置 electron-builder <code>&quot;asar&quot;: false</code>。</p>
<h2 id="second-instance-事件监听无效"><a href="#second-instance-事件监听无效" class="headerlink" title="second-instance 事件监听无效"></a><code>second-instance</code> 事件监听无效</h2><p>必须使用 <code>app.requestSingleInstanceLock()</code> 保持应用程序单例，才能正常监听到该事件。</p>
<p>示例代码</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gotTheLock = app.requestSingleInstanceLock();</span><br><span class="line"><span class="keyword">if</span> (!gotTheLock) &#123;</span><br><span class="line">  app.quit();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  app.on(<span class="string">&quot;second-instance&quot;</span>, <span class="function">(<span class="params">event, commandLine, workingDirectory</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;second-instance&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>参考: <a target="_blank" rel="noopener" href="https://www.electronjs.org/docs/api/app#apprequestsingleinstancelock">https://www.electronjs.org/docs/api/app#apprequestsingleinstancelock</a></p>
</blockquote>
<h2 id="安装浏览器扩展报错"><a href="#安装浏览器扩展报错" class="headerlink" title="安装浏览器扩展报错"></a>安装浏览器扩展报错</h2><p>提示安装失败</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(node:23488) ExtensionLoadWarning: Warnings loading extension at C:\Users\rxliuli\AppData\Roaming\Electron\extensions\fmkadmapgofadopljbjfkapdkoienihi: Unrecognized manifest key <span class="string">&#x27;browser_action&#x27;</span>. Unre</span><br><span class="line">cognized manifest key <span class="string">&#x27;minimum_chrome_version&#x27;</span>. Unrecognized manifest key <span class="string">&#x27;update_url&#x27;</span>. Cannot load extension with file or directory name _metadata. Filenames starting with <span class="string">&quot;_&quot;</span> are reserved <span class="keyword">for</span> use by</span><br><span class="line"> the system.</span><br></pre></td></tr></table></figure>
<p>其实答案是：扩展必须在 <code>app.ready</code> 之后，创建 BrowserWindow 窗口之前安装。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/25/76072311817b4c1985ab5746e8f91d87/" data-id="ckmcqox3s00520kuvboiteny4" data-title="electron 开发经验之谈系列-常见问题" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/electron/" rel="tag">electron</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-b54161d3177f463d9b91f9fa17e0fd8e" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/09/b54161d3177f463d9b91f9fa17e0fd8e/" class="article-date">
  <time class="dt-published" datetime="2020-12-09T01:57:14.000Z" itemprop="datePublished">2020-12-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/09/b54161d3177f463d9b91f9fa17e0fd8e/">CSS Grid 页面布局</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://grid.layoutit.com/">grid 可视化布局</a>, <a target="_blank" rel="noopener" href="https://css-tricks.com/snippets/css/complete-guide-grid/">css grid 完整指南</a></p>
</blockquote>
<p>早就知道 css grid 布局非常强大，但之前由于兼容性问题一直没有机会尝试，近来在生产环境中大规模尝试使用它，并尝试在 react 中进行封装：<a href="/p/a4b40427c59d4c8eb258375771b7c5d8">在 react 中优雅的使用 grid 实现页面布局</a>，于此记录一下各种常见布局的 grid 实现。</p>
<blockquote>
<p>附：grid 真的是一个非常强大自适应布局系统。</p>
</blockquote>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><blockquote>
<p>注：以下示例均默认引用了 <a target="_blank" rel="noopener" href="https://necolas.github.io/normalize.css/">Normalize.css</a></p>
</blockquote>
<h3 id="中后台基本布局"><a href="#中后台基本布局" class="headerlink" title="中后台基本布局"></a>中后台基本布局</h3><p><img src="/images/36ac0cf810e3433eb62f24cf94250346.png" alt="中后台基本布局"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">      display: grid;</span><br><span class="line"><span class="css">      <span class="comment">/* 定义行和列 */</span></span></span><br><span class="line">      grid-template-columns: 300px 1fr;</span><br><span class="line">      grid-template-rows: auto 1fr;</span><br><span class="line"><span class="css">      <span class="comment">/* 定义布局的地图，未设定 area 则默认堆叠 */</span></span></span><br><span class="line">      grid-template-areas: &quot;header header&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.header</span> &#123;</span></span><br><span class="line">      grid-area: header;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &gt; * &#123;</span></span><br><span class="line">      border: solid 1px red;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span>header<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span>&gt;</span>sidebar<span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span>&gt;</span>content<span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="/images/082f3b56a78f4be6932803df73970a85.html">中后台基本布局.html</a></p>
<h3 id="纵向布局"><a href="#纵向布局" class="headerlink" title="纵向布局"></a>纵向布局</h3><p><img src="/images/63d35c58ce5c4f38acd4fe6e9bf6ee37.png" alt="纵向布局"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">      display: grid;</span><br><span class="line">      /* 下面这行指定了</span><br><span class="line">        第一行按照内容自适应高度</span><br><span class="line">        第二行占有剩余高度</span><br><span class="line">         */</span><br><span class="line">      grid-template-rows: auto 1fr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &gt; * &#123;</span></span><br><span class="line">      border: solid 1px red;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span>header<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span>&gt;</span>content<span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="/images/72183c54283b42ada8489badd3a991af.html">纵向布局.html</a></p>
<h3 id="模拟-flex-margin-left-或-margin-right"><a href="#模拟-flex-margin-left-或-margin-right" class="headerlink" title="模拟 flex margin-left 或 margin-right"></a>模拟 flex margin-left 或 margin-right</h3><p><img src="/images/9953b8f2368a4924a03a5cc84ccee09e.png" alt="模拟 flex margin-left 或 margin-right"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">      display: grid;</span><br><span class="line"><span class="css">      <span class="comment">/* 下面两行是关键 */</span></span></span><br><span class="line">      grid-template-columns: auto 1fr auto;</span><br><span class="line">      justify-items: end;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &gt; * &#123;</span></span><br><span class="line">      border: solid 1px red;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://picsum.photos/20&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;logo&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>消息<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="/images/18b7bcdf9edb475d9fadfb31f507f2bc.html">模拟 flex margin-left 或 margin-right.html</a></p>
<h3 id="根据内容自适应贴靠在一边"><a href="#根据内容自适应贴靠在一边" class="headerlink" title="根据内容自适应贴靠在一边"></a>根据内容自适应贴靠在一边</h3><p>如下图展示一个图片列表</p>
<p><img src="/images/140f7e0e0dbd4ca6a47ddbe546cc67b6.png" alt="根据内容自适应贴靠在一边"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">      display: grid;</span><br><span class="line">      grid-template-columns: auto auto;</span><br><span class="line"><span class="css">      <span class="comment">/* 下面一行是关键，效果类似于 flex-start */</span></span></span><br><span class="line">      justify-content: start;</span><br><span class="line">      grid-gap: 8px;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://picsum.photos/seed/1/100&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://picsum.photos/seed/2/100&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://picsum.photos/seed/3/100&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://picsum.photos/seed/4/100&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://picsum.photos/seed/5/100&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://picsum.photos/seed/6/100&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="/images/dcdbdf2653eb4ee68837c3b75da00fa0.html">根据内容自适应贴靠在一边.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/09/b54161d3177f463d9b91f9fa17e0fd8e/" data-id="ckmcqox4k007r0kuvajsy7a2w" data-title="CSS Grid 页面布局" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css/" rel="tag">css</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/grid/" rel="tag">grid</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-a4b40427c59d4c8eb258375771b7c5d8" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/02/a4b40427c59d4c8eb258375771b7c5d8/" class="article-date">
  <time class="dt-published" datetime="2020-12-02T00:45:30.000Z" itemprop="datePublished">2020-12-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/02/a4b40427c59d4c8eb258375771b7c5d8/">在 react 中优雅的使用 grid 实现页面布局</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><p>吾辈在做 electron 应用的时候遇到了这种布局，顶部是 header，然后是页面中的 toolbar，紧接着右边有一个侧边栏列表，左侧的内容又分为了两块区域。这种布局在中后台系统中应该很常见，但之前并未特别留意过布局通用化。</p>
<p><img src="/images/2b76f0b1d64d437684ab41f5dde82e43.svg" alt="布局.drawio.svg"></p>
<ul>
<li>使用 <code>css calc()</code> 计算高度</li>
<li>基于 <code>css calc()</code> 封装 <code>Col/Row</code> 组件，然后使用组件进行布局（主要模仿 antd grid）</li>
<li>使用 <code>css grid</code> 自适应布局</li>
<li>使用 <code>css grid</code> 封装组件</li>
</ul>
<h2 id="使用-css-calc-计算高度"><a href="#使用-css-calc-计算高度" class="headerlink" title="使用 css calc() 计算高度"></a>使用 <code>css calc()</code> 计算高度</h2><p>最初，吾辈使用 <code>css calc()</code> 计算剩余高度，以占满全部高度。但这样实现存在的一个明显问题是，每当吾辈需要在纵向添加一行时，都要修改 <code>calc()</code> 重新计算高度。如果存在嵌套内容时，甚至会导致层层声明 <code>height: calc(100% - *px)</code>，而且难以复用，这是很难接受的。</p>
<p>下面是一个实现上面那种布局的方法</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>grid test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      * &#123;</span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line">        box-sizing: border-box;</span><br><span class="line">      &#125;</span><br><span class="line">      html,</span><br><span class="line">      body,</span><br><span class="line"><span class="css">      <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">        height: 100%;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.header</span> &#123;</span></span><br><span class="line">        height: 64px;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">        height: calc(100% - 64px);</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.toolbar</span> &#123;</span></span><br><span class="line">        height: 64px;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.content</span> &#123;</span></span><br><span class="line">        height: calc(100% - 64px);</span><br><span class="line">        display: flex;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.main-content</span> &#123;</span></span><br><span class="line">        display: inline-block;</span><br><span class="line">        width: calc(100% - 300px);</span><br><span class="line">        height: 100%;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.sider</span> &#123;</span></span><br><span class="line">        display: inline-block;</span><br><span class="line">        width: 300px;</span><br><span class="line">        height: 100%;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.form</span> &#123;</span></span><br><span class="line">        height: 300px;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.list</span> &#123;</span></span><br><span class="line">        height: calc(100% - 300px);</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.header</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.main</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.toolbar</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.content</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.sider</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.form</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.list</span> &#123;</span></span><br><span class="line">        border: solid 1px red;</span><br><span class="line">        overflow-y: auto;</span><br><span class="line">        text-align: center;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span>header<span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">main</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span>&gt;</span>toolbar<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main-content&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;form&quot;</span>&gt;</span>form<span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;list&quot;</span>&gt;</span>list<span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;sider&quot;</span>&gt;</span>sider<span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以看到，不仅 html 部分嵌套众多，css 部分也需要反复计算宽高，这实在不是一件令人愉快的代码。</p>
<h2 id="基于-css-calc-封装-Col-Row-组件布局"><a href="#基于-css-calc-封装-Col-Row-组件布局" class="headerlink" title="基于 css calc() 封装 Col/Row 组件布局"></a>基于 <code>css calc()</code> 封装 <code>Col/Row</code> 组件布局</h2><p>由于不希望每次都去写类似下面的代码，因而吾辈产生了封装组件的想法。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>初次尝试</p>
<blockquote>
<p>基本思路来源于 antd 的 <a target="_blank" rel="noopener" href="https://ant.design/components/grid-cn">Grid 布局</a>，之所以没有使用 antd grid 的原因是它并不支持纵向的布局，即便是 Layout 布局组件也不是那么好用。</p>
</blockquote>
<ul>
<li><code>FullHeight</code>: 让子组件占满父组件的全部高度</li>
<li><code>VerticalCol</code>: 占全高的一列</li>
<li><code>VerticalRow</code>: 可控制占比列中的一行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">type FullHeightProps &#x3D; &#123;</span><br><span class="line">  children: ReactElement;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * 让子组件占满父组件的全部高度</span><br><span class="line"> *&#x2F;</span><br><span class="line">const FullHeight: React.FC&lt;FullHeightProps&gt; &#x3D; (props) &#x3D;&gt; &#123;</span><br><span class="line">  return cloneElement(props.children, &#123;</span><br><span class="line">    ...props.children.props,</span><br><span class="line">    style: &#123;</span><br><span class="line">      height: &quot;100%&quot;,</span><br><span class="line">      overflowY: &quot;auto&quot;,</span><br><span class="line">      ...props.children.props.style,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 垂直布局的上下文</span><br><span class="line"></span><br><span class="line">export type VerticalColContextType &#x3D; &#123;</span><br><span class="line">  &#x2F;&#x2F;分割的份数</span><br><span class="line">  gutter: number;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * 垂直布局的上下文环境</span><br><span class="line"> *&#x2F;</span><br><span class="line">export const VerticalColContext &#x3D; createContext&lt;VerticalColContextType&gt;(&#123;</span><br><span class="line">  gutter: 24,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">type VerticalColProps &#x3D; &#123;</span><br><span class="line">  children: ReactElement&lt;VerticalRowProps&gt; | ReactElement&lt;VerticalRowProps&gt;[];</span><br><span class="line">  style?: CSSProperties;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * 垂直布局的一列</span><br><span class="line"> * 默认占父容器的全部高度</span><br><span class="line"> *&#x2F;</span><br><span class="line">const VerticalCol &#x3D; React.forwardRef&lt;HTMLDivElement, VerticalColProps&gt;(</span><br><span class="line">  (props, ref) &#x3D;&gt; (</span><br><span class="line">    &lt;VerticalColContext.Provider</span><br><span class="line">      value&#x3D;&#123;&#123;</span><br><span class="line">        gutter: 24,</span><br><span class="line">      &#125;&#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;FullHeight&gt;</span><br><span class="line">        &lt;div style&#x3D;&#123;props.style&#125; ref&#x3D;&#123;ref&#125;&gt;</span><br><span class="line">          &#123;props.children&#125;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">      &lt;&#x2F;FullHeight&gt;</span><br><span class="line">    &lt;&#x2F;VerticalColContext.Provider&gt;</span><br><span class="line">  )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export type VerticalRowProps &#x3D; &#123;</span><br><span class="line">  span?: number;</span><br><span class="line">  style?: CSSProperties;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * 用来控制每一行占比的元素</span><br><span class="line"> *&#x2F;</span><br><span class="line">const VerticalRow: React.FC&lt;VerticalRowProps&gt; &#x3D; (props) &#x3D;&gt; &#123;</span><br><span class="line">  const &#123; gutter &#125; &#x3D; useContext(VerticalColContext);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div</span><br><span class="line">      style&#x3D;&#123;&#123;</span><br><span class="line">        height: &#96;calc(100% &#x2F; $&#123;gutter&#125; * $&#123;props.span&#125;)&#96;,</span><br><span class="line">        overflowY: &quot;auto&quot;,</span><br><span class="line">        ...props.style,</span><br><span class="line">      &#125;&#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &#123;props.children&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">VerticalRow.defaultProps &#x3D; &#123;</span><br><span class="line">  span: 0,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>基本使用大概长这样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;VerticalCol</span><br><span class="line">  style&#x3D;&#123;&#123;</span><br><span class="line">    height: &quot;100%&quot;,</span><br><span class="line">  &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">  &lt;VerticalRow span&#x3D;&#123;2&#125; style&#x3D;&#123;&#123; backgroundColor: &quot;red&quot; &#125;&#125;&gt;</span><br><span class="line">    内容块 1</span><br><span class="line">  &lt;&#x2F;VerticalRow&gt;</span><br><span class="line">  &lt;VerticalRow span&#x3D;&#123;22&#125; style&#x3D;&#123;&#123; backgroundColor: &quot;green&quot; &#125;&#125;&gt;</span><br><span class="line">    内容块 2</span><br><span class="line">  &lt;&#x2F;VerticalRow&gt;</span><br><span class="line">&lt;&#x2F;VerticalCol&gt;</span><br></pre></td></tr></table></figure>
<p>看起来还不错，简单的使用组件就可以按比例分割页面了。但一旦在复杂的实际页面使用时，麻烦就接踵而来了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;VerticalCol</span><br><span class="line">  style&#x3D;&#123;&#123;</span><br><span class="line">    height: 800,</span><br><span class="line">  &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">  &lt;VerticalRow span&#x3D;&#123;2&#125; style&#x3D;&#123;&#123; backgroundColor: &quot;red&quot; &#125;&#125;&gt;</span><br><span class="line">    &lt;header&gt;</span><br><span class="line">      &lt;h1&gt;标题&lt;&#x2F;h1&gt;</span><br><span class="line">    &lt;&#x2F;header&gt;</span><br><span class="line">  &lt;&#x2F;VerticalRow&gt;</span><br><span class="line">  &lt;VerticalRow span&#x3D;&#123;22&#125; style&#x3D;&#123;&#123; backgroundColor: &quot;green&quot; &#125;&#125;&gt;</span><br><span class="line">    &lt;FullHeight&gt;</span><br><span class="line">      &lt;Row&gt;</span><br><span class="line">        &lt;FullHeight&gt;</span><br><span class="line">          &lt;Col</span><br><span class="line">            span&#x3D;&#123;18&#125;</span><br><span class="line">            style&#x3D;&#123;&#123;</span><br><span class="line">              backgroundColor: &quot;aqua&quot;,</span><br><span class="line">            &#125;&#125;</span><br><span class="line">          &gt;</span><br><span class="line">            内容区域</span><br><span class="line">          &lt;&#x2F;Col&gt;</span><br><span class="line">        &lt;&#x2F;FullHeight&gt;</span><br><span class="line">        &lt;FullHeight&gt;</span><br><span class="line">          &lt;Col</span><br><span class="line">            span&#x3D;&#123;6&#125;</span><br><span class="line">            style&#x3D;&#123;&#123;</span><br><span class="line">              backgroundColor: &quot;blue&quot;,</span><br><span class="line">            &#125;&#125;</span><br><span class="line">          &gt;</span><br><span class="line">            &#123;Array(100)</span><br><span class="line">              .fill(0)</span><br><span class="line">              .map((_, i) &#x3D;&gt; (</span><br><span class="line">                &lt;h2</span><br><span class="line">                  style&#x3D;&#123;&#123;</span><br><span class="line">                    color: &quot;white&quot;,</span><br><span class="line">                  &#125;&#125;</span><br><span class="line">                &gt;</span><br><span class="line">                  &#123;i&#125;</span><br><span class="line">                &lt;&#x2F;h2&gt;</span><br><span class="line">              ))&#125;</span><br><span class="line">          &lt;&#x2F;Col&gt;</span><br><span class="line">        &lt;&#x2F;FullHeight&gt;</span><br><span class="line">      &lt;&#x2F;Row&gt;</span><br><span class="line">    &lt;&#x2F;FullHeight&gt;</span><br><span class="line">  &lt;&#x2F;VerticalRow&gt;</span><br><span class="line">&lt;&#x2F;VerticalCol&gt;</span><br></pre></td></tr></table></figure>
<p>可以看到，这里仅仅是使用 Component 代替了 css class 而已，并未减少页面布局的复杂性，而且由于使用组件进行布局，导致组件的结构变得更深了。</p>
<h2 id="使用-css-grid-自适应布局"><a href="#使用-css-grid-自适应布局" class="headerlink" title="使用 css grid 自适应布局"></a>使用 <code>css grid</code> 自适应布局</h2><p>css grid 确实强大无比，尤其是 <code>grid-template-areas</code> 功能，直接改变了传统网页的布局方式。现在，自适应布局变得异常简单。</p>
<p>下面是使用 grid 的方式实现布局的代码，可以看到最复杂的部分其实是在 <code>grid-template-areas</code>，它确定了不同元素占有的区块。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>grid test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      html,</span><br><span class="line">      body,</span><br><span class="line"><span class="css">      <span class="selector-class">.grid-container</span> &#123;</span></span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line">        box-sizing: border-box;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">      <span class="selector-class">.grid-container</span> &#123;</span></span><br><span class="line">        height: 100%;</span><br><span class="line">        display: grid;</span><br><span class="line">        grid-template-columns: 1fr 300px;</span><br><span class="line">        grid-template-rows: 64px 64px 430px 1fr;</span><br><span class="line">        grid-template-areas:</span><br><span class="line">          &quot;header header&quot;</span><br><span class="line">          &quot;toolbar toolbar&quot;</span><br><span class="line">          &quot;form sider&quot;</span><br><span class="line">          &quot;list sider&quot;;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.header</span> &#123;</span></span><br><span class="line">        grid-area: header;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.toolbar</span> &#123;</span></span><br><span class="line">        grid-area: toolbar;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.sider</span> &#123;</span></span><br><span class="line">        grid-area: sider;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.form</span> &#123;</span></span><br><span class="line">        grid-area: form;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.list</span> &#123;</span></span><br><span class="line">        grid-area: list;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.header</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.toolbar</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.sider</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.form</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-class">.list</span> &#123;</span></span><br><span class="line">        border: 1px solid red;</span><br><span class="line">        overflow-y: auto;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;grid-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;sider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;form&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;list&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>但 grid 也并非尽善尽美，它仅对直接子组件生效，而孙子及其子节点则不在 <code>grid</code> 的布局范围，这导致为子组件编写 grid 布局样式时，仍然存在一些样板代码。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 下面是典型的样板代码 */</span></span><br><span class="line"><span class="selector-class">.grid-container</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="attribute">grid-area</span>: header;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.toolbar</span> &#123;</span><br><span class="line">  <span class="attribute">grid-area</span>: toolbar;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.sider</span> &#123;</span><br><span class="line">  <span class="attribute">grid-area</span>: sider;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.form</span> &#123;</span><br><span class="line">  <span class="attribute">grid-area</span>: form;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> &#123;</span><br><span class="line">  <span class="attribute">grid-area</span>: list;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.header</span>,</span><br><span class="line"><span class="selector-class">.toolbar</span>,</span><br><span class="line"><span class="selector-class">.sider</span>,</span><br><span class="line"><span class="selector-class">.form</span>,</span><br><span class="line"><span class="selector-class">.list</span> &#123;</span><br><span class="line">  <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="使用-css-grid-封装组件"><a href="#使用-css-grid-封装组件" class="headerlink" title="使用 css grid 封装组件"></a>使用 <code>css grid</code> 封装组件</h2><p>事实上，吾辈确实找到了一个现有的基于 grid 的 react 布局组件库 <a target="_blank" rel="noopener" href="https://github.com/STRML/react-grid-layout">react-grid-layout</a>，而且非常强大，但很遗憾的是它并 <a target="_blank" rel="noopener" href="https://github.com/STRML/react-grid-layout/issues/1329">不支持 react 17</a>。但其 api 及封装方式确实有参考意义，所以吾辈也尝试封装一个 <code>Grid</code> 组件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">type Unit &#x3D; &#96;$&#123;number&#125;$&#123;&quot;px&quot; | &quot;fr&quot;&#125;&#96;;</span><br><span class="line"></span><br><span class="line">type GridProps&lt;</span><br><span class="line">  T extends string,</span><br><span class="line">  R extends Unit[] &#x3D; Unit[],</span><br><span class="line">  C extends Unit[] &#x3D; Unit[],</span><br><span class="line">  A extends &#123; [P in keyof R]: &#123; [P in keyof C]: T &#125; &#125; &#x3D; &#123;</span><br><span class="line">    [P in keyof R]: &#123; [P in keyof C]: T &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&gt; &#x3D; &#123;</span><br><span class="line">  rows: R;</span><br><span class="line">  cols: C;</span><br><span class="line">  areas: A;</span><br><span class="line">  children: ReactElement[];</span><br><span class="line">&#125; &amp; CommonStyleProps;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * 使用 grid 进行布局的容器组件</span><br><span class="line"> *&#x2F;</span><br><span class="line">function Grid&lt;T extends string&gt;(props: GridProps&lt;T&gt;) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div</span><br><span class="line">      className&#x3D;&#123;props.className&#125;</span><br><span class="line">      style&#x3D;&#123;</span><br><span class="line">        &#123;</span><br><span class="line">          height: &quot;100%&quot;,</span><br><span class="line">          display: &quot;grid&quot;,</span><br><span class="line">          gridTemplateColumns: props.cols.join(&quot; &quot;),</span><br><span class="line">          gridTemplateRows: props.rows.join(&quot; &quot;),</span><br><span class="line">          gridTemplateAreas: props.areas</span><br><span class="line">            .map((row) &#x3D;&gt; &#39;&quot;&#39; + row.join(&quot; &quot;) + &#39;&quot;&#39;)</span><br><span class="line">            .join(&quot; &quot;),</span><br><span class="line">          ...props.style,</span><br><span class="line">        &#125; as CSSProperties</span><br><span class="line">      &#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &#123;props.children.map((child) &#x3D;&gt; &#123;</span><br><span class="line">        console.log(&quot;child key: &quot;, child.key);</span><br><span class="line">        return cloneElement(child, &#123;</span><br><span class="line">          ...child.props,</span><br><span class="line">          style: &#123;</span><br><span class="line">            gridArea: child.key,</span><br><span class="line">            border: &quot;solid 1px red&quot;,</span><br><span class="line">          &#125; as CSSProperties,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;)&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用起来比较简单，唯一残念的是子元素中的 key 无法使用 ts 自动推导或强制约束。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;Grid&lt;AreaItemName&gt;</span><br><span class="line">  style&#x3D;&#123;&#123;</span><br><span class="line">    height: &quot;calc(100vh - 48px)&quot;,</span><br><span class="line">  &#125;&#125;</span><br><span class="line">  rows&#x3D;&#123;[&quot;48px&quot;, &quot;48px&quot;, &quot;300px&quot;, &quot;1fr&quot;]&#125;</span><br><span class="line">  cols&#x3D;&#123;[&quot;1fr&quot;, &quot;300px&quot;]&#125;</span><br><span class="line">  areas&#x3D;&#123;[</span><br><span class="line">    [&quot;header&quot;, &quot;header&quot;],</span><br><span class="line">    [&quot;toolbar&quot;, &quot;toolbar&quot;],</span><br><span class="line">    [&quot;form&quot;, &quot;sider&quot;],</span><br><span class="line">    [&quot;list&quot;, &quot;sider&quot;],</span><br><span class="line">  ]&#125;</span><br><span class="line">&gt;</span><br><span class="line">  &lt;header key&#x3D;&#123;&quot;header&quot; as AreaItemName&#125;&gt;header&lt;&#x2F;header&gt;</span><br><span class="line">  &lt;section key&#x3D;&#123;&quot;toolbar&quot; as AreaItemName&#125;&gt;toolbar&lt;&#x2F;section&gt;</span><br><span class="line">  &lt;section key&#x3D;&#123;&quot;sider&quot; as AreaItemName&#125;&gt;sider&lt;&#x2F;section&gt;</span><br><span class="line">  &lt;section key&#x3D;&#123;&quot;form&quot; as AreaItemName&#125;&gt;form&lt;&#x2F;section&gt;</span><br><span class="line">  &lt;section key&#x3D;&#123;&quot;list&quot; as AreaItemName&#125;&gt;list&lt;&#x2F;section&gt;</span><br><span class="line">&lt;&#x2F;Grid&gt;</span><br></pre></td></tr></table></figure>
<p>看起来不错，然而实际上这还是有缺陷的。</p>
<ol>
<li>子组件必须处理了 <code>props.style</code>，因为 <code>cloneElement</code> 仅仅为原组件注入了属性（默认的 react html 元素均已处理）<ol>
<li> 当布局的子组件需要监听滚动时，由于外层使用 div 在自定义组件外部，实际上并不能取到 ref，需要在业务组件再设置一次滚动。</li>
</ol>
</li>
<li> 类型约束未能完全生效，例如子元素的 key，就没办法做到类型自动推导限定</li>
<li> 子组件内容过多时仍然会导致父元素出现滚动条</li>
</ol>
<p>接下来一个个解决</p>
<h3 id="1-子组件必须处理了-props-style，因为-cloneElement-仅仅为原组件注入了属性（默认的-react-html-元素均已处理）"><a href="#1-子组件必须处理了-props-style，因为-cloneElement-仅仅为原组件注入了属性（默认的-react-html-元素均已处理）" class="headerlink" title="1. 子组件必须处理了 props.style，因为 cloneElement 仅仅为原组件注入了属性（默认的 react html 元素均已处理）"></a>1. 子组件必须处理了 <code>props.style</code>，因为 <code>cloneElement</code> 仅仅为原组件注入了属性（默认的 react html 元素均已处理）</h3><p>当需要为自定义的业务组件布局时，有两种思路</p>
<ol>
<li> 在外层套 <code>div</code></li>
<li> 由组件处理 <code>props.style</code></li>
</ol>
<p>但这两种方式各有优劣</p>
<p>前者父组件的布局不会受到子组件影响，意味着子组件更容易被复用。后者在子组件内部需要使用 ref 时，不需要再额外声明 css 以使之成为可滚动元素。</p>
<p>下面是一个混合使用两者的的例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">const style: CSSProperties &#x3D; &#123; border: &quot;solid 1px red&quot; &#125;;</span><br><span class="line">type AreaItemName &#x3D; &quot;header&quot; | &quot;content&quot; | &quot;sider&quot;;</span><br><span class="line"></span><br><span class="line">function Header() &#123;</span><br><span class="line">  return &lt;header style&#x3D;&#123;style&#125;&gt;header&lt;&#x2F;header&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Content() &#123;</span><br><span class="line">  return &lt;main style&#x3D;&#123;style&#125;&gt;content&lt;&#x2F;main&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Sider(props: CommonStyleProps) &#123;</span><br><span class="line">  const $ref &#x3D; useRef&lt;HTMLElement&gt;(null);</span><br><span class="line">  return wrapper(</span><br><span class="line">    &lt;section style&#x3D;&#123;style&#125; ref&#x3D;&#123;$ref&#125;&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &#123;Array(100)</span><br><span class="line">          .fill(0)</span><br><span class="line">          .map((_, i) &#x3D;&gt; (</span><br><span class="line">            &lt;li key&#x3D;&#123;i&#125;&gt;&#123;i&#125;&lt;&#x2F;li&gt;</span><br><span class="line">          ))&#125;</span><br><span class="line">      &lt;&#x2F;ul&gt;</span><br><span class="line">      &lt;BackTop target&#x3D;&#123;() &#x3D;&gt; $ref.current!&#125;&gt;</span><br><span class="line">        &lt;ToTopOutlined</span><br><span class="line">          style&#x3D;&#123;</span><br><span class="line">            &#123;</span><br><span class="line">              fontSize: 24,</span><br><span class="line">              padding: 8,</span><br><span class="line">              borderRadius: &quot;50%&quot;,</span><br><span class="line">              color: &quot;#ffffff&quot;,</span><br><span class="line">              backgroundColor: &quot;#8ECAFE&quot;,</span><br><span class="line">            &#125; as CSSProperties</span><br><span class="line">          &#125;</span><br><span class="line">        &#x2F;&gt;</span><br><span class="line">      &lt;&#x2F;BackTop&gt;</span><br><span class="line">    &lt;&#x2F;section&gt;,</span><br><span class="line">    props</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return (</span><br><span class="line">  &lt;Grid&lt;AreaItemName&gt;</span><br><span class="line">    style&#x3D;&#123;&#123;</span><br><span class="line">      height: &quot;calc(100vh - 48px)&quot;,</span><br><span class="line">    &#125;&#125;</span><br><span class="line">    rows&#x3D;&#123;[&quot;48px&quot;, &quot;1fr&quot;]&#125;</span><br><span class="line">    cols&#x3D;&#123;[&quot;1fr&quot;, &quot;300px&quot;]&#125;</span><br><span class="line">    areas&#x3D;&#123;[[&quot;header&quot;, &quot;header&quot;]]&#125;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;div key&#x3D;&#123;&quot;header&quot; as AreaItemName&#125;&gt;</span><br><span class="line">      &lt;Header &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;Content &#x2F;&gt;</span><br><span class="line">    &lt;Sider &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;Grid&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="2-类型约束未能完全生效，例如子元素的-key，就没办法做到类型自动推导限定"><a href="#2-类型约束未能完全生效，例如子元素的-key，就没办法做到类型自动推导限定" class="headerlink" title="2. 类型约束未能完全生效，例如子元素的 key，就没办法做到类型自动推导限定"></a>2. 类型约束未能完全生效，例如子元素的 key，就没办法做到类型自动推导限定</h3><p>目前很难处理 <code>ReactElement</code> 类型，导致相关的类型自动推导特别麻烦，so…暂时没有好的办法。</p>
<h3 id="3-子组件内容过多时仍然会导致父元素出现滚动条"><a href="#3-子组件内容过多时仍然会导致父元素出现滚动条" class="headerlink" title="3. 子组件内容过多时仍然会导致父元素出现滚动条"></a>3. 子组件内容过多时仍然会导致父元素出现滚动条</h3><p>为子组件设置默认 <code>height/overflowY</code> 即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">function Grid&lt;T extends string&gt;(props: GridProps&lt;T&gt;) &#123;</span><br><span class="line">  const &#123; cols &#x3D; [], rows &#x3D; [], areas &#x3D; [], children &#125; &#x3D; props;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div</span><br><span class="line">      className&#x3D;&#123;props.className&#125;</span><br><span class="line">      style&#x3D;&#123;</span><br><span class="line">        &#123;</span><br><span class="line">          height: &quot;100%&quot;,</span><br><span class="line">          overflowY: &quot;auto&quot;,</span><br><span class="line">          display: &quot;grid&quot;,</span><br><span class="line">          gridTemplateColumns: cols.join(&quot; &quot;),</span><br><span class="line">          gridTemplateRows: rows.join(&quot; &quot;),</span><br><span class="line">          gridTemplateAreas: areas</span><br><span class="line">            .map((row) &#x3D;&gt; &#39;&quot;&#39; + row.join(&quot; &quot;) + &#39;&quot;&#39;)</span><br><span class="line">            .join(&quot; &quot;),</span><br><span class="line">          ...props.style,</span><br><span class="line">        &#125; as CSSProperties</span><br><span class="line">      &#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &#123;children.map((child) &#x3D;&gt; &#123;</span><br><span class="line">        return cloneElement(child, &#123;</span><br><span class="line">          ...child.props,</span><br><span class="line">          style: &#123;</span><br><span class="line">            &#x2F;&#x2F; 这里是关键</span><br><span class="line">            height: &quot;100%&quot;,</span><br><span class="line">            overflowY: &quot;auto&quot;,</span><br><span class="line">            gridArea: child.key,</span><br><span class="line">            ...child.props.style,</span><br><span class="line">          &#125; as CSSProperties,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;)&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>老实说吾辈对现代前端的生态乱象表示很讨厌，尤其是 react 生态的 css 处理方案，仅 css-in-js 就有几十种可选方案，而官方又没有作为，导致没有统一的方式（vue 在这点上好很多）处理它们，所以吾辈才选择了 ui 组件 + css module 的方式。乍一看似乎回到了 HTML 标签控制样式的情况，但相比之下<strong>组件</strong>比 HTML 标签灵活得多，而且更容易扩展和组合（如果使用了 css 预处理器就是另外一回事了）。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/02/a4b40427c59d4c8eb258375771b7c5d8/" data-id="ckmcqox49006s0kuv6iyh2gqa" data-title="在 react 中优雅的使用 grid 实现页面布局" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css/" rel="tag">css</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/grid/" rel="tag">grid</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react/" rel="tag">react</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-4b666902cd1e45779448a76a71d0e2e5" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/11/19/4b666902cd1e45779448a76a71d0e2e5/" class="article-date">
  <time class="dt-published" datetime="2020-11-19T00:46:50.000Z" itemprop="datePublished">2020-11-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/11/19/4b666902cd1e45779448a76a71d0e2e5/">前端资源管理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="框架及社区"><a href="#框架及社区" class="headerlink" title="框架及社区"></a>框架及社区</h2><ul>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/">react</a>: 前端流行的 mvc 框架<ul>
<li><a target="_blank" rel="noopener" href="https://create-react-app.dev/">create-react-app</a>: react 官方的脚手架</li>
<li><a target="_blank" rel="noopener" href="https://reactrouter.com/">react-router</a>: react 上的路由管理库<ul>
<li><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-router-config">react-router-config</a>: 集中式的 react-router 路由管理库</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/gsoft-inc/craco">craco</a>: react 的一个非官方的无需 eject 即可覆盖 cra 内部配置的打包库</li>
<li><a target="_blank" rel="noopener" href="https://github.com/streamich/react-use">react-use</a>: react hooks 通用库</li>
<li><a target="_blank" rel="noopener" href="https://ant.design/">antd</a>: 极其强大的中后台 ui 组件库<ul>
<li><a target="_blank" rel="noopener" href="https://ant.design/components/icon/">@ant-design/icons</a>: antd 的图标库</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://immerjs.github.io/immer/">immer</a>: 简化 react 中不可变数据的修改</li>
<li><a target="_blank" rel="noopener" href="https://peterbeshai.com/use-query-params/">use-query-params</a>: 处理 react router 中的 query params<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/sindresorhus/query-string#readme">query-string</a>: 所依赖的 url 查询字符串库，必须手动添加以使用最新版本</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/JedWatson/classnames">classnames</a>: react css module 简化工具</li>
<li><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-infinite-scroller">react-infinite-scroller</a>: react 无限滚动通用组件</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://vuejs.org/">vue</a>: 国人开发的 mvvm 框架，更小更加轻量<ul>
<li><a target="_blank" rel="noopener" href="https://cli.vuejs.org/">vue-cli</a>: vue 官方的脚手架</li>
<li><a target="_blank" rel="noopener" href="https://router.vuejs.org/">vue-router</a>: vue 官方的集中式路由管理库</li>
<li><a target="_blank" rel="noopener" href="https://vuex.vuejs.org/">vuex</a>: vue 官方的 flux 状态管理库</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/">typescript</a>: 为 js 添加了类型系统</li>
<li><a target="_blank" rel="noopener" href="https://mobx.js.org/">mobx</a>: 跨框架可变式的全局状态管理库</li>
<li><a target="_blank" rel="noopener" href="https://xstate.js.org/">xstate</a>: 跨框架的状态机</li>
<li><a target="_blank" rel="noopener" href="https://esdoc.org/">esdoc</a>: js 中最好的 api 文档生成工具</li>
<li><a target="_blank" rel="noopener" href="https://typedoc.org/">typedoc</a>: ts 中目前最好的 api 文档生成工具（但仍然没有上面的 esdoc 好）</li>
<li><a target="_blank" rel="noopener" href="https://storybook.js.org/">storybook</a>: 跨框架的 ui 组件文档生成器</li>
<li><a target="_blank" rel="noopener" href="https://github.com/piotrwitek/type-fest">type-fest</a>: typescript 类型工具库</li>
<li><a target="_blank" rel="noopener" href="https://github.com/marak/Faker.js/">faker</a>: mock 数据生成</li>
<li><a target="_blank" rel="noopener" href="https://github.com/axios/axios">axios</a>: 通用 ajax 请求库</li>
<li><a target="_blank" rel="noopener" href="https://github.com/DefinitelyTyped/DefinitelyTyped">@types/*</a>: 社区类型定义库</li>
<li><a target="_blank" rel="noopener" href="https://prettier.io/">prettier</a>: 代码统一格式化工具</li>
<li><a target="_blank" rel="noopener" href="https://eslint.org/">eslint</a>: 前端可配置的 linter 工具（实测还是没有 WebStorm 的内置 linter 好用）</li>
<li><a target="_blank" rel="noopener" href="https://github.com/uuidjs/uuid">uuid</a>: 前端 uuid 生成工具</li>
<li><a target="_blank" rel="noopener" href="https://stuk.github.io/jszip/">jszip</a>: js 上的 zip 处理库</li>
<li><a target="_blank" rel="noopener" href="https://dexie.org/">dexie</a>: Web IndexedDB 封装</li>
<li><a target="_blank" rel="noopener" href="https://github.com/stipsan/scroll-into-view-if-needed">scroll-into-view-if-needed</a>: 控制 dom 元素滚动到视图区域的工具库</li>
<li><a target="_blank" rel="noopener" href="https://github.com/lindell/JsBarcode">jsbarcode</a>: 生成一维码</li>
<li><a target="_blank" rel="noopener" href="https://github.com/iansinnott/react-string-replace">react-string-replace</a>: react 中将 <code>string</code> 替换为 jsx 的工具函数</li>
<li><a target="_blank" rel="noopener" href="https://github.com/crabbly/Print.js">print-js</a>: 浏览器端打印 pdf 的工具库</li>
<li><a target="_blank" rel="noopener" href="https://github.com/moment/luxon">luxon</a>: 日期时间库</li>
</ul>
<h2 id="nodejs-上的工具"><a href="#nodejs-上的工具" class="headerlink" title="nodejs 上的工具"></a>nodejs 上的工具</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/rollup/rollup">rollup</a>: 前端 npm 库打包工具</li>
<li><a target="_blank" rel="noopener" href="https://github.com/toddbluhm/env-cmd">env-cmd</a>: 跨平台设置环境变量</li>
<li><a target="_blank" rel="noopener" href="https://github.com/gulpjs/gulp">gulp</a>: 流式 task 工具</li>
<li><a target="_blank" rel="noopener" href="https://github.com/typicode/husky">husky</a>: 为项目配置 git 钩子</li>
<li><a target="_blank" rel="noopener" href="https://github.com/okonet/lint-staged">lint-staged</a>: 针对暂存的 git 文件运行 linters</li>
<li><a target="_blank" rel="noopener" href="https://github.com/GoogleChromeLabs/worker-plugin">worker-plugin</a>: webpack worker 插件<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/GoogleChromeLabs/comlink">comlink</a>: 基于 Proxy 的一个 web worker rpc 实现</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://jestjs.io/">jest</a>: 单元测试框架<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/kulshekhar/ts-jest">ts-jest</a>: 支持 ts 单元测试的预设配置</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/TypeStrong/ts-node">ts-node</a>: 直接运行 ts 文件</li>
<li><a target="_blank" rel="noopener" href="https://github.com/jprichardson/node-fs-extra">fs-extra</a>: nodejs fs 模块的 Promise 包装超集</li>
<li><a target="_blank" rel="noopener" href="https://github.com/shelljs/shx">shx</a>: npm 中的跨平台 *unix 命令</li>
<li><a target="_blank" rel="noopener" href="https://github.com/kurttheviking/git-rev-sync-js">git-rev-sync</a>: 读取当前项目的 git 信息</li>
<li><a target="_blank" rel="noopener" href="https://electronjs.org/">electron</a>: Web 跨平台客户端解决方案<ul>
<li><a target="_blank" rel="noopener" href="https://www.electron.build/">electron-builder</a>: electron 打包/更新一站式解决方案</li>
<li><a target="_blank" rel="noopener" href="https://github.com/MarshallOfSound/electron-devtools-installer">electron-devtools-installer</a>: electron 客户端安装开发插件</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/webpack-contrib/webpack-bundle-analyzer">webpack-bundle-analyzer</a>: web 打包分析</li>
<li><a target="_blank" rel="noopener" href="https://www.lodashjs.com/">lodash</a>: 前端通用工具库</li>
<li><a target="_blank" rel="noopener" href="https://github.com/theophilusx/ssh2-sftp-client">ssh2-sftp-client</a>: sftp 工具库</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Level/levelup">levelup</a>: 跨语言的高性能键值存储</li>
<li><a target="_blank" rel="noopener" href="https://github.com/sindresorhus/open">open</a>: 在 nodejs 中打开链接、文件之类的东西</li>
<li><a target="_blank" rel="noopener" href="https://github.com/artiebits/pdf-to-printer">pdf-to-printer</a>: 使用 nodejs 打印 pdf 的函数库</li>
<li><a target="_blank" rel="noopener" href="https://github.com/sindresorhus/os-locale">os-locale</a>: 在 nodejs 获取系统语言</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ajv-validator/ajv">ajv</a>: 前端 json 校验</li>
<li><a target="_blank" rel="noopener" href="https://github.com/steveukx/git-js">simple-git</a>: 操作 git 的 npm 库</li>
<li><a target="_blank" rel="noopener" href="https://github.com/google/diff-match-patch">diff-match-patch</a>: Google 的文本差异对比</li>
<li><a target="_blank" rel="noopener" href="https://github.com/typeorm/typeorm">typeorm</a>: nodejs orm 库，和 nest.js 有着良好的集成</li>
<li><a target="_blank" rel="noopener" href="https://remark.js.org/">remark</a>: markdown 社区及工具集</li>
<li><a target="_blank" rel="noopener" href="https://github.com/puppeteer/puppeteer">puppeteer</a>: 无头浏览器</li>
</ul>
<h2 id="有用的资源和社区"><a href="#有用的资源和社区" class="headerlink" title="有用的资源和社区"></a>有用的资源和社区</h2><ul>
<li><a target="_blank" rel="noopener" href="https://react-typescript-cheatsheet.netlify.app/">react+ts 使用指南</a></li>
<li><a target="_blank" rel="noopener" href="https://grid.layoutit.com/">grid 可视化布局生成器</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/sparanoid/chinese-copywriting-guidelines">中文文档排版指北</a></li>
<li><a target="_blank" rel="noopener" href="https://css-tricks.com/">css 全面指南</a></li>
<li><a target="_blank" rel="noopener" href="https://reactjsexample.com/">react 示例网站</a></li>
</ul>
<h2 id="待定"><a href="#待定" class="headerlink" title="待定"></a>待定</h2><ul>
<li><a target="_blank" rel="noopener" href="https://tailwindcss.com/">tailwind.css</a>: 实用且全面的工具库</li>
<li><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/img-clipboard">img-clipboard</a>: 在 nodejs 中复制剪切板中的图像</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/11/19/4b666902cd1e45779448a76a71d0e2e5/" data-id="ckmcqox38003j0kuv9ftv1ij4" data-title="前端资源管理" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" rel="tag">工程化</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-c5bef8ccf92349939dc07daad2acd61c" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/11/15/c5bef8ccf92349939dc07daad2acd61c/" class="article-date">
  <time class="dt-published" datetime="2020-11-15T01:06:23.000Z" itemprop="datePublished">2020-11-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/11/15/c5bef8ccf92349939dc07daad2acd61c/">为什么有那么多笔记工具</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>真是疯了，吾辈发现网络上有太多的笔记工具了。</p>
<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>吾辈在大约半年前选择开始使用笔记工具，记录自己的日常知识碎片，并最终选择了 <a target="_blank" rel="noopener" href="https://joplinapp.org/">Joplin</a>，也花费了许多时间为其编写 <a target="_blank" rel="noopener" href="https://github.com/rxliuli/joplin-vscode-plugin">VSCode 插件</a>。就在今天，吾辈在编写插件的一个功能时，需要查看类似插件是如何实现的时候，发现了许多类似的插件存在，甚至包括吾辈想在 VSCode 中管理和编辑笔记的想法也已然有人实现。</p>
<p>让我们看一下玩家有哪些</p>
<p>老牌产品</p>
<ul>
<li>Evernote</li>
<li>OneNote</li>
<li>Apple Notes</li>
</ul>
<p>基于 Web/Electron/较新型工具</p>
<ul>
<li>Notion</li>
<li>Joplin</li>
<li>Roam</li>
<li>Bear</li>
<li>Obsidian</li>
<li>RemNote</li>
<li>Zettelkasten</li>
<li>Typora</li>
<li>marktext</li>
<li>Standard Notes</li>
<li>Google Keep</li>
</ul>
<p>基于 VSCode</p>
<ul>
<li>Foam</li>
<li>dendron</li>
</ul>
<p>国产</p>
<ul>
<li>有道云笔记</li>
<li>语雀</li>
<li>思源笔记</li>
</ul>
<p>还有更多。。。</p>
<p>吾辈列一下其中几个吾辈已经用过的，横向对比</p>
<table>
<thead>
<tr>
<th>产品</th>
<th>Web</th>
<th>PC 跨平台</th>
<th>移动端</th>
<th>数据库/文件</th>
<th>搜索速度</th>
<th>VSCode 集成</th>
<th>Markdown 支持</th>
<th>支持全量导出</th>
<th>UI</th>
</tr>
</thead>
<tbody><tr>
<td>Evernote</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>数据库</td>
<td>快</td>
<td>否</td>
<td>不完全</td>
<td>否</td>
<td>一般</td>
</tr>
<tr>
<td>OneNote</td>
<td>是</td>
<td>是</td>
<td>是</td>
<td>数据库</td>
<td>快</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>清新</td>
</tr>
<tr>
<td>Notion</td>
<td>是</td>
<td>是</td>
<td>是</td>
<td>数据库</td>
<td>慢</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>漂亮</td>
</tr>
<tr>
<td>Joplin</td>
<td>是</td>
<td>是</td>
<td>是</td>
<td>数据库</td>
<td>快</td>
<td>是</td>
<td>是</td>
<td>是</td>
<td>一般</td>
</tr>
<tr>
<td>Typora</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>文件</td>
<td>快</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>简洁</td>
</tr>
<tr>
<td>marktext</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>文件</td>
<td>快</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>漂亮</td>
</tr>
<tr>
<td>Google Keep</td>
<td>是</td>
<td>否</td>
<td>是</td>
<td>数据库</td>
<td>慢</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>简洁</td>
</tr>
</tbody></table>
<p>这真的有那么重要么？为什么有这么多的工具，或者说，为什么有这么多的人、这么多的公司愿意花费那么多的时间去编写各种各样的工具，难道最终不是只会出现一个或几个优胜者么？<br>这太糟糕了，吾辈感觉自己在为一件注定失败的事情浪费时间，相比之下更应该等到出现胜者之后再进行选择。</p>
<p>有人说</p>
<ul>
<li>因为需求不一致</li>
<li>说明这个市场很大</li>
<li>说明知识焦虑在扩散 终生学习的需求越来越大，不迭代就会被淘汰</li>
<li>因为笔记软件好多年都没什么大发展了吧，最近一段时间开始风起云涌</li>
<li>都好多年了吧……如果从 org 开始算，就更久了</li>
</ul>
<blockquote>
<p>在做一件事上，应该只有一个工具是最好的。</p>
</blockquote>
<p>吾辈对于笔记的主要关注点</p>
<ul>
<li>[x] 基于 Markdown: 不基于任何特定格式的富文本是最容易长期保存的</li>
<li>[x] 支持全量导出: 任何公司都有可能倒闭，所以全量导出可以容易的迁出</li>
<li>[x] 编辑器足够好用，最好支持 VSCode 直接编辑: 作为一个程序员实在难以离开强大的编辑器</li>
<li>[x] 搜索速度要快: 笔记如果无法快速找到，就失去了知识管理的意义</li>
<li>[ ] 移动端基本查看支持: 有时候可能要在移动端分享一下</li>
<li>[ ] WebClipper 浏览器插件支持</li>
<li>[ ] 图片等二进制资源支持</li>
<li>[ ] 多平台同步支持</li>
<li>[ ] 基本的 wiki 功能（笔记之间互相引用）</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://collegeinfogeek.com/best-note-taking-apps/">The 11 Best Note-Taking Apps in 2020 – Evernote, Notion, and More</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/11/15/c5bef8ccf92349939dc07daad2acd61c/" data-id="ckmcqox4s008d0kuv5p02gicv" data-title="为什么有那么多笔记工具" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA/" rel="tag">个人</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-32a5980cdf284cf2b107a3ee04ff71f4" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/09/25/32a5980cdf284cf2b107a3ee04ff71f4/" class="article-date">
  <time class="dt-published" datetime="2020-09-25T02:03:49.000Z" itemprop="datePublished">2020-09-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/09/25/32a5980cdf284cf2b107a3ee04ff71f4/">使用 gh-pages 发布前端项目</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/gh-pages">gh-pages</a></p>
</blockquote>
<p>之前就有在使用 gh-pages 这个库，但由于名字并未想到它如此强大，甚至支持发布代码到任意 git 仓库。换言之，它可以将任意本地文件发布到远端 git 仓库，而不需要自己处理各种乱七八糟的问题。</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>首先说一下我们之前前后端分离项目的发布流程</p>
<ol>
<li> 修改打包的 webpack 脚本以支持引用 cdn 上的资源（本质上是修改路径）</li>
<li> 打包静态资源文件</li>
<li> 找到前端静态资源发布项目，切换到指定分支</li>
<li> 复制静态资源到特定目录</li>
<li> <code>git commit &amp;&amp; git push</code></li>
<li> 如果要发布 cdn 则再次对 cdn 仓库同样如此操作</li>
<li> 通知后端发布生产环境，进行验证</li>
</ol>
<p>这其中涉及到几个重要痛点</p>
<ol>
<li> 修改 webpack 配置，它极高的复杂度甚至产生了 <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/267908710">webpack 配置工程师</a> 这一职业岗位。</li>
<li> 处理文件复制提交 git 信息，有可能操作错误，每次发布生产都是一次心理上的考验</li>
<li> 发布失败难以快速解决，重新发布又需要手动再走一遍流程，所以有了我之前说过的发布一次要半个钟的事实</li>
</ol>
<h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>不难看出，这本质上还是因为发布没有自动化带来的问题。但是，在 DevOps 还不存在的情况下，gh-pages 能够自动化下面的两步，同时，像 <code>create-react-app/vue-cli</code> 这种基于 webpack 进行高层次封装的工具提供了 <code>PUBLIC_PATH</code> 的概念，能够通过环境变量指定 <code>index.html</code> 入口引用的其他静态资源的基本路径，即便不去碰 webpack 也可以处理第一个问题了。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://create-react-app.dev/docs/using-the-public-folder/">react</a>, <a target="_blank" rel="noopener" href="https://cli.vuejs.org/zh/config/#publicpath">vue</a></p>
</blockquote>
<p>大致过程如下</p>
<ol>
<li><p> 在项目中添加依赖 <code>yarn add -D env-cmd gh-pages</code></p>
</li>
<li><p> 在打包生产环境的资源时指定环境变量 <code>PUBLIC_URL=[cdn 发布后的远端基本路径]</code></p>
</li>
<li><p>添加发布 script 命令</p>
 <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;deploy&quot;</span>: <span class="string">&quot;yarn build:prod &amp;&amp; yarn deploy:cdn &amp;&amp; yarn deploy:publish&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;deploy:publish&quot;</span>: <span class="string">&quot;gh-pages -d [本地目录] -e [远端 git 目录] -r [远端 git 地址] -b [远端 git 分支]&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;deploy:cdn&quot;</span>: <span class="string">&quot;gh-pages -d [本地目录] -e [远端 git 目录] -r [远端 git 地址] -b [远端 git 分支]&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在，发布生产环境只需要两个步骤</p>
</li>
<li><p> 运行 <code>deploy</code> 命令</p>
</li>
<li><p> 通知后端发布 cdn/静态资源目录</p>
</li>
</ol>
<p>虽然仍未能解决前后端不分离的项目，但，至少解决了所有新项目的发布问题了，不是么？</p>
<blockquote>
<p>这里有一个项目已经如此实现，可以进行参考：<a target="_blank" rel="noopener" href="https://git.code.tencent.com/bingli_front/website-static">website-static</a></p>
</blockquote>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>还是需要擅用工具，如果能够掌握更好的工具，效率的提高和自己的痛苦程度都能有极大的改善！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/09/25/32a5980cdf284cf2b107a3ee04ff71f4/" data-id="ckmcqox2v002i0kuvgs7a8q77" data-title="使用 gh-pages 发布前端项目" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react/" rel="tag">react</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" rel="tag">工程化</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-96499825cae64978a6546b036c00a29e" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/09/08/96499825cae64978a6546b036c00a29e/" class="article-date">
  <time class="dt-published" datetime="2020-09-08T02:13:16.000Z" itemprop="datePublished">2020-09-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/09/08/96499825cae64978a6546b036c00a29e/">使用 vscode + draw.io 轻松绘制流程图</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=hediet.vscode-drawio-insiders-build">vscode 扩展</a></p>
</blockquote>
<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><h2 id="考察"><a href="#考察" class="headerlink" title="考察"></a>考察</h2><p>事实上吾辈也有做过相当的考察，用过几个知名的流程图工具，但最终选择 vscode-drawio 插件。</p>
<ul>
<li><code>plantuml</code>: 复杂</li>
<li><code>mermaid</code>: 复杂，但通过 js 编写，web 友好</li>
<li><code>processOn</code>: 付费，不开放</li>
<li><code>drawio</code>: 开源、免费，可独立部署或集成</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/09/08/96499825cae64978a6546b036c00a29e/" data-id="ckmcqox44006c0kuvcu9c5wp9" data-title="使用 vscode + draw.io 轻松绘制流程图" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/" rel="tag">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electron/" rel="tag">electron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grid/" rel="tag">grid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jetbrains/" rel="tag">jetbrains</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/" rel="tag">markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/" rel="tag">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/typescript/" rel="tag">typescript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webstorm/" rel="tag">webstorm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA/" rel="tag">个人</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%AC%E5%8F%B8/" rel="tag">公司</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%91%A8%E6%8A%A5/" rel="tag">周报</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%A3%E5%91%8A/" rel="tag">宣告</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" rel="tag">工程化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E6%BA%90/" rel="tag">开源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%82%E6%AD%A5/" rel="tag">异步</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%85%E6%9B%B4%E6%96%B0/" rel="tag">待更新</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%8F%E9%AA%8C/" rel="tag">经验</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6/" rel="tag">读书</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag">转载</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/css/" style="font-size: 12.14px;">css</a> <a href="/tags/electron/" style="font-size: 15.71px;">electron</a> <a href="/tags/git/" style="font-size: 12.86px;">git</a> <a href="/tags/grid/" style="font-size: 10.71px;">grid</a> <a href="/tags/java/" style="font-size: 19.29px;">java</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/jetbrains/" style="font-size: 12.14px;">jetbrains</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/markdown/" style="font-size: 10.71px;">markdown</a> <a href="/tags/react/" style="font-size: 14.29px;">react</a> <a href="/tags/sql/" style="font-size: 14.29px;">sql</a> <a href="/tags/typescript/" style="font-size: 12.14px;">typescript</a> <a href="/tags/vscode/" style="font-size: 12.86px;">vscode</a> <a href="/tags/vue/" style="font-size: 16.43px;">vue</a> <a href="/tags/webstorm/" style="font-size: 10px;">webstorm</a> <a href="/tags/windows/" style="font-size: 17.14px;">windows</a> <a href="/tags/%E4%B8%AA%E4%BA%BA/" style="font-size: 12.86px;">个人</a> <a href="/tags/%E5%85%AC%E5%8F%B8/" style="font-size: 10px;">公司</a> <a href="/tags/%E5%91%A8%E6%8A%A5/" style="font-size: 10px;">周报</a> <a href="/tags/%E5%AE%A3%E5%91%8A/" style="font-size: 10px;">宣告</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 13.57px;">工具</a> <a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" style="font-size: 17.86px;">工程化</a> <a href="/tags/%E5%BC%80%E6%BA%90/" style="font-size: 10px;">开源</a> <a href="/tags/%E5%BC%82%E6%AD%A5/" style="font-size: 15px;">异步</a> <a href="/tags/%E5%BE%85%E6%9B%B4%E6%96%B0/" style="font-size: 10.71px;">待更新</a> <a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 18.57px;">杂谈</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a> <a href="/tags/%E7%BB%8F%E9%AA%8C/" style="font-size: 11.43px;">经验</a> <a href="/tags/%E8%AF%BB%E4%B9%A6/" style="font-size: 12.14px;">读书</a> <a href="/tags/%E8%BD%AC%E8%BD%BD/" style="font-size: 11.43px;">转载</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/14/8fb2d58463ae4191ac064a76e15bffbd/">2021 第十周</a>
          </li>
        
          <li>
            <a href="/2021/03/12/7e7131c07c984d928ba3fefa7a9cef06/">读书-[颓废与沉默：透视犬儒文化]</a>
          </li>
        
          <li>
            <a href="/2021/03/02/db74e6e5d2444bc3b6e185a7b338bbf6/">electron 开发经验之谈系列-在渲染、主进程间共享数据</a>
          </li>
        
          <li>
            <a href="/2021/02/27/06cb464179cf45c598208534705aae3c/">2020 吾辈在公司推动的前端技术演进</a>
          </li>
        
          <li>
            <a href="/2021/02/23/cd66150d2b86448590fcc9bb2419c0b2/">实践 lerna monorepo</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>